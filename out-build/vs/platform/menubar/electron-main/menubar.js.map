{"version":3,"sources":["vs/platform/menubar/electron-main/menubar.ts"],"names":[],"mappings":"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","file":"menubar.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { app, BrowserWindow, KeyboardEvent, Menu, MenuItem, MenuItemConstructorOptions, WebContents } from 'electron';\nimport { WorkbenchActionExecutedClassification, WorkbenchActionExecutedEvent } from 'vs/base/common/actions';\nimport { RunOnceScheduler } from 'vs/base/common/async';\nimport { CancellationToken } from 'vs/base/common/cancellation';\nimport { mnemonicMenuLabel } from 'vs/base/common/labels';\nimport { isMacintosh, language } from 'vs/base/common/platform';\nimport { URI } from 'vs/base/common/uri';\nimport * as nls from 'vs/nls';\nimport { IConfigurationService } from 'vs/platform/configuration/common/configuration';\nimport { IEnvironmentMainService } from 'vs/platform/environment/electron-main/environmentMainService';\nimport { ILifecycleMainService } from 'vs/platform/lifecycle/electron-main/lifecycleMainService';\nimport { ILogService } from 'vs/platform/log/common/log';\nimport { IMenubarData, IMenubarKeybinding, IMenubarMenu, IMenubarMenuRecentItemAction, isMenubarMenuItemAction, isMenubarMenuItemRecentAction, isMenubarMenuItemSeparator, isMenubarMenuItemSubmenu, MenubarMenuItem } from 'vs/platform/menubar/common/menubar';\nimport { INativeHostMainService } from 'vs/platform/native/electron-main/nativeHostMainService';\nimport { IProductService } from 'vs/platform/product/common/productService';\nimport { IStateService } from 'vs/platform/state/node/state';\nimport { ITelemetryService } from 'vs/platform/telemetry/common/telemetry';\nimport { IUpdateService, StateType } from 'vs/platform/update/common/update';\nimport { getTitleBarStyle, INativeRunActionInWindowRequest, INativeRunKeybindingInWindowRequest, IWindowOpenable } from 'vs/platform/window/common/window';\nimport { IWindowsCountChangedEvent, IWindowsMainService, OpenContext } from 'vs/platform/windows/electron-main/windows';\nimport { IWorkspacesHistoryMainService } from 'vs/platform/workspaces/electron-main/workspacesHistoryMainService';\n\nconst telemetryFrom = 'menu';\n\ninterface IMenuItemClickHandler {\n\tinDevTools: (contents: WebContents) => void;\n\tinNoWindow: () => void;\n}\n\ntype IMenuItemInvocation = (\n\t{ type: 'commandId'; commandId: string }\n\t| { type: 'keybinding'; userSettingsLabel: string }\n);\n\ninterface IMenuItemWithKeybinding {\n\tuserSettingsLabel?: string;\n}\n\nexport class Menubar {\n\n\tprivate static readonly lastKnownMenubarStorageKey = 'lastKnownMenubarData';\n\n\tprivate willShutdown: boolean | undefined;\n\tprivate appMenuInstalled: boolean | undefined;\n\tprivate closedLastWindow: boolean;\n\tprivate noActiveWindow: boolean;\n\n\tprivate menuUpdater: RunOnceScheduler;\n\tprivate menuGC: RunOnceScheduler;\n\n\t// Array to keep menus around so that GC doesn't cause crash as explained in #55347\n\t// TODO@sbatten Remove this when fixed upstream by Electron\n\tprivate oldMenus: Menu[];\n\n\tprivate menubarMenus: { [id: string]: IMenubarMenu };\n\n\tprivate keybindings: { [commandId: string]: IMenubarKeybinding };\n\n\tprivate readonly fallbackMenuHandlers: { [id: string]: (menuItem: MenuItem, browserWindow: BrowserWindow | undefined, event: KeyboardEvent) => void } = Object.create(null);\n\n\tconstructor(\n\t\t@IUpdateService private readonly updateService: IUpdateService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@IWindowsMainService private readonly windowsMainService: IWindowsMainService,\n\t\t@IEnvironmentMainService private readonly environmentMainService: IEnvironmentMainService,\n\t\t@ITelemetryService private readonly telemetryService: ITelemetryService,\n\t\t@IWorkspacesHistoryMainService private readonly workspacesHistoryMainService: IWorkspacesHistoryMainService,\n\t\t@IStateService private readonly stateService: IStateService,\n\t\t@ILifecycleMainService private readonly lifecycleMainService: ILifecycleMainService,\n\t\t@ILogService private readonly logService: ILogService,\n\t\t@INativeHostMainService private readonly nativeHostMainService: INativeHostMainService,\n\t\t@IProductService private readonly productService: IProductService\n\t) {\n\t\tthis.menuUpdater = new RunOnceScheduler(() => this.doUpdateMenu(), 0);\n\n\t\tthis.menuGC = new RunOnceScheduler(() => { this.oldMenus = []; }, 10000);\n\n\t\tthis.menubarMenus = Object.create(null);\n\t\tthis.keybindings = Object.create(null);\n\n\t\tif (isMacintosh || getTitleBarStyle(this.configurationService) === 'native') {\n\t\t\tthis.restoreCachedMenubarData();\n\t\t}\n\n\t\tthis.addFallbackHandlers();\n\n\t\tthis.closedLastWindow = false;\n\t\tthis.noActiveWindow = false;\n\n\t\tthis.oldMenus = [];\n\n\t\tthis.install();\n\n\t\tthis.registerListeners();\n\t}\n\n\tprivate restoreCachedMenubarData() {\n\t\tconst menubarData = this.stateService.getItem<IMenubarData>(Menubar.lastKnownMenubarStorageKey);\n\t\tif (menubarData) {\n\t\t\tif (menubarData.menus) {\n\t\t\t\tthis.menubarMenus = menubarData.menus;\n\t\t\t}\n\n\t\t\tif (menubarData.keybindings) {\n\t\t\t\tthis.keybindings = menubarData.keybindings;\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate addFallbackHandlers(): void {\n\n\t\t// File Menu Items\n\t\tthis.fallbackMenuHandlers['workbench.action.files.newUntitledFile'] = (menuItem, win, event) => this.windowsMainService.openEmptyWindow({ context: OpenContext.MENU, contextWindowId: win?.id });\n\t\tthis.fallbackMenuHandlers['workbench.action.newWindow'] = (menuItem, win, event) => this.windowsMainService.openEmptyWindow({ context: OpenContext.MENU, contextWindowId: win?.id });\n\t\tthis.fallbackMenuHandlers['workbench.action.files.openFileFolder'] = (menuItem, win, event) => this.nativeHostMainService.pickFileFolderAndOpen(undefined, { forceNewWindow: this.isOptionClick(event), telemetryExtraData: { from: telemetryFrom } });\n\t\tthis.fallbackMenuHandlers['workbench.action.files.openFolder'] = (menuItem, win, event) => this.nativeHostMainService.pickFolderAndOpen(undefined, { forceNewWindow: this.isOptionClick(event), telemetryExtraData: { from: telemetryFrom } });\n\t\tthis.fallbackMenuHandlers['workbench.action.openWorkspace'] = (menuItem, win, event) => this.nativeHostMainService.pickWorkspaceAndOpen(undefined, { forceNewWindow: this.isOptionClick(event), telemetryExtraData: { from: telemetryFrom } });\n\n\t\t// Recent Menu Items\n\t\tthis.fallbackMenuHandlers['workbench.action.clearRecentFiles'] = () => this.workspacesHistoryMainService.clearRecentlyOpened();\n\n\t\t// Help Menu Items\n\t\tconst youTubeUrl = this.productService.youTubeUrl;\n\t\tif (youTubeUrl) {\n\t\t\tthis.fallbackMenuHandlers['workbench.action.openYouTubeUrl'] = () => this.openUrl(youTubeUrl, 'openYouTubeUrl');\n\t\t}\n\n\t\tconst requestFeatureUrl = this.productService.requestFeatureUrl;\n\t\tif (requestFeatureUrl) {\n\t\t\tthis.fallbackMenuHandlers['workbench.action.openRequestFeatureUrl'] = () => this.openUrl(requestFeatureUrl, 'openUserVoiceUrl');\n\t\t}\n\n\t\tconst reportIssueUrl = this.productService.reportIssueUrl;\n\t\tif (reportIssueUrl) {\n\t\t\tthis.fallbackMenuHandlers['workbench.action.openIssueReporter'] = () => this.openUrl(reportIssueUrl, 'openReportIssues');\n\t\t}\n\n\t\tconst licenseUrl = this.productService.licenseUrl;\n\t\tif (licenseUrl) {\n\t\t\tthis.fallbackMenuHandlers['workbench.action.openLicenseUrl'] = () => {\n\t\t\t\tif (language) {\n\t\t\t\t\tconst queryArgChar = licenseUrl.indexOf('?') > 0 ? '&' : '?';\n\t\t\t\t\tthis.openUrl(`${licenseUrl}${queryArgChar}lang=${language}`, 'openLicenseUrl');\n\t\t\t\t} else {\n\t\t\t\t\tthis.openUrl(licenseUrl, 'openLicenseUrl');\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\tconst privacyStatementUrl = this.productService.privacyStatementUrl;\n\t\tif (privacyStatementUrl && licenseUrl) {\n\t\t\tthis.fallbackMenuHandlers['workbench.action.openPrivacyStatementUrl'] = () => {\n\t\t\t\tthis.openUrl(privacyStatementUrl, 'openPrivacyStatement');\n\t\t\t};\n\t\t}\n\t}\n\n\tprivate registerListeners(): void {\n\n\t\t// Keep flag when app quits\n\t\tthis.lifecycleMainService.onWillShutdown(() => this.willShutdown = true);\n\n\t\t// Listen to some events from window service to update menu\n\t\tthis.windowsMainService.onDidChangeWindowsCount(e => this.onDidChangeWindowsCount(e));\n\t\tthis.nativeHostMainService.onDidBlurWindow(() => this.onDidChangeWindowFocus());\n\t\tthis.nativeHostMainService.onDidFocusWindow(() => this.onDidChangeWindowFocus());\n\t}\n\n\tprivate get currentEnableMenuBarMnemonics(): boolean {\n\t\tconst enableMenuBarMnemonics = this.configurationService.getValue('window.enableMenuBarMnemonics');\n\t\tif (typeof enableMenuBarMnemonics !== 'boolean') {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn enableMenuBarMnemonics;\n\t}\n\n\tprivate get currentEnableNativeTabs(): boolean {\n\t\tif (!isMacintosh) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst enableNativeTabs = this.configurationService.getValue('window.nativeTabs');\n\t\tif (typeof enableNativeTabs !== 'boolean') {\n\t\t\treturn false;\n\t\t}\n\t\treturn enableNativeTabs;\n\t}\n\n\tupdateMenu(menubarData: IMenubarData, windowId: number) {\n\t\tthis.menubarMenus = menubarData.menus;\n\t\tthis.keybindings = menubarData.keybindings;\n\n\t\t// Save off new menu and keybindings\n\t\tthis.stateService.setItem(Menubar.lastKnownMenubarStorageKey, menubarData);\n\n\t\tthis.scheduleUpdateMenu();\n\t}\n\n\n\tprivate scheduleUpdateMenu(): void {\n\t\tthis.menuUpdater.schedule(); // buffer multiple attempts to update the menu\n\t}\n\n\tprivate doUpdateMenu(): void {\n\n\t\t// Due to limitations in Electron, it is not possible to update menu items dynamically. The suggested\n\t\t// workaround from Electron is to set the application menu again.\n\t\t// See also https://github.com/electron/electron/issues/846\n\t\t//\n\t\t// Run delayed to prevent updating menu while it is open\n\t\tif (!this.willShutdown) {\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (!this.willShutdown) {\n\t\t\t\t\tthis.install();\n\t\t\t\t}\n\t\t\t}, 10 /* delay this because there is an issue with updating a menu when it is open */);\n\t\t}\n\t}\n\n\tprivate onDidChangeWindowsCount(e: IWindowsCountChangedEvent): void {\n\t\tif (!isMacintosh) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Update menu if window count goes from N > 0 or 0 > N to update menu item enablement\n\t\tif ((e.oldCount === 0 && e.newCount > 0) || (e.oldCount > 0 && e.newCount === 0)) {\n\t\t\tthis.closedLastWindow = e.newCount === 0;\n\t\t\tthis.scheduleUpdateMenu();\n\t\t}\n\t}\n\n\tprivate onDidChangeWindowFocus(): void {\n\t\tif (!isMacintosh) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.noActiveWindow = !BrowserWindow.getFocusedWindow();\n\t\tthis.scheduleUpdateMenu();\n\t}\n\n\tprivate install(): void {\n\t\t// Store old menu in our array to avoid GC to collect the menu and crash. See #55347\n\t\t// TODO@sbatten Remove this when fixed upstream by Electron\n\t\tconst oldMenu = Menu.getApplicationMenu();\n\t\tif (oldMenu) {\n\t\t\tthis.oldMenus.push(oldMenu);\n\t\t}\n\n\t\t// If we don't have a menu yet, set it to null to avoid the electron menu.\n\t\t// This should only happen on the first launch ever\n\t\tif (Object.keys(this.menubarMenus).length === 0) {\n\t\t\tMenu.setApplicationMenu(isMacintosh ? new Menu() : null);\n\t\t\treturn;\n\t\t}\n\n\t\t// Menus\n\t\tconst menubar = new Menu();\n\n\t\t// Mac: Application\n\t\tlet macApplicationMenuItem: MenuItem;\n\t\tif (isMacintosh) {\n\t\t\tconst applicationMenu = new Menu();\n\t\t\tmacApplicationMenuItem = new MenuItem({ label: this.productService.nameShort, submenu: applicationMenu });\n\t\t\tthis.setMacApplicationMenu(applicationMenu);\n\t\t\tmenubar.append(macApplicationMenuItem);\n\t\t}\n\n\t\t// Mac: Dock\n\t\tif (isMacintosh && !this.appMenuInstalled) {\n\t\t\tthis.appMenuInstalled = true;\n\n\t\t\tconst dockMenu = new Menu();\n\t\t\tdockMenu.append(new MenuItem({ label: this.mnemonicLabel(nls.localize({ key: 'miNewWindow', comment: ['&& denotes a mnemonic'] }, \"New &&Window\")), click: () => this.windowsMainService.openEmptyWindow({ context: OpenContext.DOCK }) }));\n\n\t\t\tapp.dock.setMenu(dockMenu);\n\t\t}\n\n\t\t// File\n\t\tif (this.shouldDrawMenu('File')) {\n\t\t\tconst fileMenu = new Menu();\n\t\t\tconst fileMenuItem = new MenuItem({ label: this.mnemonicLabel(nls.localize({ key: 'mFile', comment: ['&& denotes a mnemonic'] }, \"&&File\")), submenu: fileMenu });\n\t\t\tthis.setMenuById(fileMenu, 'File');\n\t\t\tmenubar.append(fileMenuItem);\n\t\t}\n\n\t\t// Edit\n\t\tif (this.shouldDrawMenu('Edit')) {\n\t\t\tconst editMenu = new Menu();\n\t\t\tconst editMenuItem = new MenuItem({ label: this.mnemonicLabel(nls.localize({ key: 'mEdit', comment: ['&& denotes a mnemonic'] }, \"&&Edit\")), submenu: editMenu });\n\t\t\tthis.setMenuById(editMenu, 'Edit');\n\t\t\tmenubar.append(editMenuItem);\n\t\t}\n\n\t\t// Selection\n\t\tif (this.shouldDrawMenu('Selection')) {\n\t\t\tconst selectionMenu = new Menu();\n\t\t\tconst selectionMenuItem = new MenuItem({ label: this.mnemonicLabel(nls.localize({ key: 'mSelection', comment: ['&& denotes a mnemonic'] }, \"&&Selection\")), submenu: selectionMenu });\n\t\t\tthis.setMenuById(selectionMenu, 'Selection');\n\t\t\tmenubar.append(selectionMenuItem);\n\t\t}\n\n\t\t// View\n\t\tif (this.shouldDrawMenu('View')) {\n\t\t\tconst viewMenu = new Menu();\n\t\t\tconst viewMenuItem = new MenuItem({ label: this.mnemonicLabel(nls.localize({ key: 'mView', comment: ['&& denotes a mnemonic'] }, \"&&View\")), submenu: viewMenu });\n\t\t\tthis.setMenuById(viewMenu, 'View');\n\t\t\tmenubar.append(viewMenuItem);\n\t\t}\n\n\t\t// Go\n\t\tif (this.shouldDrawMenu('Go')) {\n\t\t\tconst gotoMenu = new Menu();\n\t\t\tconst gotoMenuItem = new MenuItem({ label: this.mnemonicLabel(nls.localize({ key: 'mGoto', comment: ['&& denotes a mnemonic'] }, \"&&Go\")), submenu: gotoMenu });\n\t\t\tthis.setMenuById(gotoMenu, 'Go');\n\t\t\tmenubar.append(gotoMenuItem);\n\t\t}\n\n\t\t// Debug\n\t\tif (this.shouldDrawMenu('Run')) {\n\t\t\tconst debugMenu = new Menu();\n\t\t\tconst debugMenuItem = new MenuItem({ label: this.mnemonicLabel(nls.localize({ key: 'mRun', comment: ['&& denotes a mnemonic'] }, \"&&Run\")), submenu: debugMenu });\n\t\t\tthis.setMenuById(debugMenu, 'Run');\n\t\t\tmenubar.append(debugMenuItem);\n\t\t}\n\n\t\t// Terminal\n\t\tif (this.shouldDrawMenu('Terminal')) {\n\t\t\tconst terminalMenu = new Menu();\n\t\t\tconst terminalMenuItem = new MenuItem({ label: this.mnemonicLabel(nls.localize({ key: 'mTerminal', comment: ['&& denotes a mnemonic'] }, \"&&Terminal\")), submenu: terminalMenu });\n\t\t\tthis.setMenuById(terminalMenu, 'Terminal');\n\t\t\tmenubar.append(terminalMenuItem);\n\t\t}\n\n\t\t// Mac: Window\n\t\tlet macWindowMenuItem: MenuItem | undefined;\n\t\tif (this.shouldDrawMenu('Window')) {\n\t\t\tconst windowMenu = new Menu();\n\t\t\tmacWindowMenuItem = new MenuItem({ label: this.mnemonicLabel(nls.localize('mWindow', \"Window\")), submenu: windowMenu, role: 'window' });\n\t\t\tthis.setMacWindowMenu(windowMenu);\n\t\t}\n\n\t\tif (macWindowMenuItem) {\n\t\t\tmenubar.append(macWindowMenuItem);\n\t\t}\n\n\t\t// Help\n\t\tif (this.shouldDrawMenu('Help')) {\n\t\t\tconst helpMenu = new Menu();\n\t\t\tconst helpMenuItem = new MenuItem({ label: this.mnemonicLabel(nls.localize({ key: 'mHelp', comment: ['&& denotes a mnemonic'] }, \"&&Help\")), submenu: helpMenu, role: 'help' });\n\t\t\tthis.setMenuById(helpMenu, 'Help');\n\t\t\tmenubar.append(helpMenuItem);\n\t\t}\n\n\t\tif (menubar.items && menubar.items.length > 0) {\n\t\t\tMenu.setApplicationMenu(menubar);\n\t\t} else {\n\t\t\tMenu.setApplicationMenu(null);\n\t\t}\n\n\t\t// Dispose of older menus after some time\n\t\tthis.menuGC.schedule();\n\t}\n\n\tprivate setMacApplicationMenu(macApplicationMenu: Menu): void {\n\t\tconst about = this.createMenuItem(nls.localize('mAbout', \"About {0}\", this.productService.nameLong), 'workbench.action.showAboutDialog');\n\t\tconst checkForUpdates = this.getUpdateMenuItems();\n\n\t\tlet preferences;\n\t\tif (this.shouldDrawMenu('Preferences')) {\n\t\t\tconst preferencesMenu = new Menu();\n\t\t\tthis.setMenuById(preferencesMenu, 'Preferences');\n\t\t\tpreferences = new MenuItem({ label: this.mnemonicLabel(nls.localize({ key: 'miPreferences', comment: ['&& denotes a mnemonic'] }, \"&&Preferences\")), submenu: preferencesMenu });\n\t\t}\n\n\t\tconst servicesMenu = new Menu();\n\t\tconst services = new MenuItem({ label: nls.localize('mServices', \"Services\"), role: 'services', submenu: servicesMenu });\n\t\tconst hide = new MenuItem({ label: nls.localize('mHide', \"Hide {0}\", this.productService.nameLong), role: 'hide', accelerator: 'Command+H' });\n\t\tconst hideOthers = new MenuItem({ label: nls.localize('mHideOthers', \"Hide Others\"), role: 'hideOthers', accelerator: 'Command+Alt+H' });\n\t\tconst showAll = new MenuItem({ label: nls.localize('mShowAll', \"Show All\"), role: 'unhide' });\n\t\tconst quit = new MenuItem(this.likeAction('workbench.action.quit', {\n\t\t\tlabel: nls.localize('miQuit', \"Quit {0}\", this.productService.nameLong), click: async (item, window, event) => {\n\t\t\t\tconst lastActiveWindow = this.windowsMainService.getLastActiveWindow();\n\t\t\t\tif (\n\t\t\t\t\tthis.windowsMainService.getWindowCount() === 0 || \t// allow to quit when no more windows are open\n\t\t\t\t\t!!BrowserWindow.getFocusedWindow() ||\t\t\t\t// allow to quit when window has focus (fix for https://github.com/microsoft/vscode/issues/39191)\n\t\t\t\t\tlastActiveWindow?.isMinimized()\t\t\t\t\t\t// allow to quit when window has no focus but is minimized (https://github.com/microsoft/vscode/issues/63000)\n\t\t\t\t) {\n\t\t\t\t\tconst confirmed = await this.confirmBeforeQuit(event);\n\t\t\t\t\tif (confirmed) {\n\t\t\t\t\t\tthis.nativeHostMainService.quit(undefined);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\n\t\tconst actions = [about];\n\t\tactions.push(...checkForUpdates);\n\n\t\tif (preferences) {\n\t\t\tactions.push(...[\n\t\t\t\t__separator__(),\n\t\t\t\tpreferences\n\t\t\t]);\n\t\t}\n\n\t\tactions.push(...[\n\t\t\t__separator__(),\n\t\t\tservices,\n\t\t\t__separator__(),\n\t\t\thide,\n\t\t\thideOthers,\n\t\t\tshowAll,\n\t\t\t__separator__(),\n\t\t\tquit\n\t\t]);\n\n\t\tactions.forEach(i => macApplicationMenu.append(i));\n\t}\n\n\tprivate async confirmBeforeQuit(event: KeyboardEvent): Promise<boolean> {\n\t\tif (this.windowsMainService.getWindowCount() === 0) {\n\t\t\treturn true; // never confirm when no windows are opened\n\t\t}\n\n\t\tconst confirmBeforeClose = this.configurationService.getValue<'always' | 'never' | 'keyboardOnly'>('window.confirmBeforeClose');\n\t\tif (confirmBeforeClose === 'always' || (confirmBeforeClose === 'keyboardOnly' && this.isKeyboardEvent(event))) {\n\t\t\tconst { response } = await this.nativeHostMainService.showMessageBox(this.windowsMainService.getFocusedWindow()?.id, {\n\t\t\t\ttype: 'question',\n\t\t\t\tbuttons: [\n\t\t\t\t\tnls.localize({ key: 'quit', comment: ['&& denotes a mnemonic'] }, \"&&Quit\"),\n\t\t\t\t\tnls.localize('cancel', \"Cancel\")\n\t\t\t\t],\n\t\t\t\tmessage: nls.localize('quitMessage', \"Are you sure you want to quit?\")\n\t\t\t});\n\n\t\t\treturn response === 0;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tprivate shouldDrawMenu(menuId: string): boolean {\n\t\t// We need to draw an empty menu to override the electron default\n\t\tif (!isMacintosh && getTitleBarStyle(this.configurationService) === 'custom') {\n\t\t\treturn false;\n\t\t}\n\n\t\tswitch (menuId) {\n\t\t\tcase 'File':\n\t\t\tcase 'Help':\n\t\t\t\tif (isMacintosh) {\n\t\t\t\t\treturn (this.windowsMainService.getWindowCount() === 0 && this.closedLastWindow) || (this.windowsMainService.getWindowCount() > 0 && this.noActiveWindow) || (!!this.menubarMenus && !!this.menubarMenus[menuId]);\n\t\t\t\t}\n\n\t\t\tcase 'Window':\n\t\t\t\tif (isMacintosh) {\n\t\t\t\t\treturn (this.windowsMainService.getWindowCount() === 0 && this.closedLastWindow) || (this.windowsMainService.getWindowCount() > 0 && this.noActiveWindow) || !!this.menubarMenus;\n\t\t\t\t}\n\n\t\t\tdefault:\n\t\t\t\treturn this.windowsMainService.getWindowCount() > 0 && (!!this.menubarMenus && !!this.menubarMenus[menuId]);\n\t\t}\n\t}\n\n\n\tprivate setMenu(menu: Menu, items: Array<MenubarMenuItem>) {\n\t\titems.forEach((item: MenubarMenuItem) => {\n\t\t\tif (isMenubarMenuItemSeparator(item)) {\n\t\t\t\tmenu.append(__separator__());\n\t\t\t} else if (isMenubarMenuItemSubmenu(item)) {\n\t\t\t\tconst submenu = new Menu();\n\t\t\t\tconst submenuItem = new MenuItem({ label: this.mnemonicLabel(item.label), submenu });\n\t\t\t\tthis.setMenu(submenu, item.submenu.items);\n\t\t\t\tmenu.append(submenuItem);\n\t\t\t} else if (isMenubarMenuItemRecentAction(item)) {\n\t\t\t\tmenu.append(this.createOpenRecentMenuItem(item));\n\t\t\t} else if (isMenubarMenuItemAction(item)) {\n\t\t\t\tif (item.id === 'workbench.action.showAboutDialog') {\n\t\t\t\t\tthis.insertCheckForUpdatesItems(menu);\n\t\t\t\t}\n\n\t\t\t\tif (isMacintosh) {\n\t\t\t\t\tif ((this.windowsMainService.getWindowCount() === 0 && this.closedLastWindow) ||\n\t\t\t\t\t\t(this.windowsMainService.getWindowCount() > 0 && this.noActiveWindow)) {\n\t\t\t\t\t\t// In the fallback scenario, we are either disabled or using a fallback handler\n\t\t\t\t\t\tif (this.fallbackMenuHandlers[item.id]) {\n\t\t\t\t\t\t\tmenu.append(new MenuItem(this.likeAction(item.id, { label: this.mnemonicLabel(item.label), click: this.fallbackMenuHandlers[item.id] })));\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tmenu.append(this.createMenuItem(item.label, item.id, false, item.checked));\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmenu.append(this.createMenuItem(item.label, item.id, item.enabled === false ? false : true, !!item.checked));\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tmenu.append(this.createMenuItem(item.label, item.id, item.enabled === false ? false : true, !!item.checked));\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate setMenuById(menu: Menu, menuId: string): void {\n\t\tif (this.menubarMenus && this.menubarMenus[menuId]) {\n\t\t\tthis.setMenu(menu, this.menubarMenus[menuId].items);\n\t\t}\n\t}\n\n\tprivate insertCheckForUpdatesItems(menu: Menu) {\n\t\tconst updateItems = this.getUpdateMenuItems();\n\t\tif (updateItems.length) {\n\t\t\tupdateItems.forEach(i => menu.append(i));\n\t\t\tmenu.append(__separator__());\n\t\t}\n\t}\n\n\tprivate createOpenRecentMenuItem(item: IMenubarMenuRecentItemAction): MenuItem {\n\t\tconst revivedUri = URI.revive(item.uri);\n\t\tconst commandId = item.id;\n\t\tconst openable: IWindowOpenable =\n\t\t\t(commandId === 'openRecentFile') ? { fileUri: revivedUri } :\n\t\t\t\t(commandId === 'openRecentWorkspace') ? { workspaceUri: revivedUri } : { folderUri: revivedUri };\n\n\t\treturn new MenuItem(this.likeAction(commandId, {\n\t\t\tlabel: item.label,\n\t\t\tclick: async (menuItem, win, event) => {\n\t\t\t\tconst openInNewWindow = this.isOptionClick(event);\n\t\t\t\tconst success = (await this.windowsMainService.open({\n\t\t\t\t\tcontext: OpenContext.MENU,\n\t\t\t\t\tcli: this.environmentMainService.args,\n\t\t\t\t\turisToOpen: [openable],\n\t\t\t\t\tforceNewWindow: openInNewWindow,\n\t\t\t\t\tgotoLineMode: false,\n\t\t\t\t\tremoteAuthority: item.remoteAuthority\n\t\t\t\t})).length > 0;\n\n\t\t\t\tif (!success) {\n\t\t\t\t\tawait this.workspacesHistoryMainService.removeRecentlyOpened([revivedUri]);\n\t\t\t\t}\n\t\t\t}\n\t\t}, false));\n\t}\n\n\tprivate isOptionClick(event: KeyboardEvent): boolean {\n\t\treturn !!(event && ((!isMacintosh && (event.ctrlKey || event.shiftKey)) || (isMacintosh && (event.metaKey || event.altKey))));\n\t}\n\n\tprivate isKeyboardEvent(event: KeyboardEvent): boolean {\n\t\treturn !!(event.triggeredByAccelerator || event.altKey || event.ctrlKey || event.metaKey || event.shiftKey);\n\t}\n\n\tprivate createRoleMenuItem(label: string, commandId: string, role: any): MenuItem {\n\t\tconst options: MenuItemConstructorOptions = {\n\t\t\tlabel: this.mnemonicLabel(label),\n\t\t\trole,\n\t\t\tenabled: true\n\t\t};\n\n\t\treturn new MenuItem(this.withKeybinding(commandId, options));\n\t}\n\n\tprivate setMacWindowMenu(macWindowMenu: Menu): void {\n\t\tconst minimize = new MenuItem({ label: nls.localize('mMinimize', \"Minimize\"), role: 'minimize', accelerator: 'Command+M', enabled: this.windowsMainService.getWindowCount() > 0 });\n\t\tconst zoom = new MenuItem({ label: nls.localize('mZoom', \"Zoom\"), role: 'zoom', enabled: this.windowsMainService.getWindowCount() > 0 });\n\t\tconst bringAllToFront = new MenuItem({ label: nls.localize('mBringToFront', \"Bring All to Front\"), role: 'front', enabled: this.windowsMainService.getWindowCount() > 0 });\n\t\tconst switchWindow = this.createMenuItem(nls.localize({ key: 'miSwitchWindow', comment: ['&& denotes a mnemonic'] }, \"Switch &&Window...\"), 'workbench.action.switchWindow');\n\n\t\tconst nativeTabMenuItems: MenuItem[] = [];\n\t\tif (this.currentEnableNativeTabs) {\n\t\t\tnativeTabMenuItems.push(__separator__());\n\n\t\t\tnativeTabMenuItems.push(this.createMenuItem(nls.localize('mNewTab', \"New Tab\"), 'workbench.action.newWindowTab'));\n\n\t\t\tnativeTabMenuItems.push(this.createRoleMenuItem(nls.localize('mShowPreviousTab', \"Show Previous Tab\"), 'workbench.action.showPreviousWindowTab', 'selectPreviousTab'));\n\t\t\tnativeTabMenuItems.push(this.createRoleMenuItem(nls.localize('mShowNextTab', \"Show Next Tab\"), 'workbench.action.showNextWindowTab', 'selectNextTab'));\n\t\t\tnativeTabMenuItems.push(this.createRoleMenuItem(nls.localize('mMoveTabToNewWindow', \"Move Tab to New Window\"), 'workbench.action.moveWindowTabToNewWindow', 'moveTabToNewWindow'));\n\t\t\tnativeTabMenuItems.push(this.createRoleMenuItem(nls.localize('mMergeAllWindows', \"Merge All Windows\"), 'workbench.action.mergeAllWindowTabs', 'mergeAllWindows'));\n\t\t}\n\n\t\t[\n\t\t\tminimize,\n\t\t\tzoom,\n\t\t\t__separator__(),\n\t\t\tswitchWindow,\n\t\t\t...nativeTabMenuItems,\n\t\t\t__separator__(),\n\t\t\tbringAllToFront\n\t\t].forEach(item => macWindowMenu.append(item));\n\t}\n\n\tprivate getUpdateMenuItems(): MenuItem[] {\n\t\tconst state = this.updateService.state;\n\n\t\tswitch (state.type) {\n\t\t\tcase StateType.Idle:\n\t\t\t\treturn [new MenuItem({\n\t\t\t\t\tlabel: this.mnemonicLabel(nls.localize('miCheckForUpdates', \"Check for &&Updates...\")), click: () => setTimeout(() => {\n\t\t\t\t\t\tthis.reportMenuActionTelemetry('CheckForUpdate');\n\t\t\t\t\t\tthis.updateService.checkForUpdates(true);\n\t\t\t\t\t}, 0)\n\t\t\t\t})];\n\n\t\t\tcase StateType.CheckingForUpdates:\n\t\t\t\treturn [new MenuItem({ label: nls.localize('miCheckingForUpdates', \"Checking for Updates...\"), enabled: false })];\n\n\t\t\tcase StateType.AvailableForDownload:\n\t\t\t\treturn [new MenuItem({\n\t\t\t\t\tlabel: this.mnemonicLabel(nls.localize('miDownloadUpdate', \"D&&ownload Available Update\")), click: () => {\n\t\t\t\t\t\tthis.updateService.downloadUpdate();\n\t\t\t\t\t}\n\t\t\t\t})];\n\n\t\t\tcase StateType.Downloading:\n\t\t\t\treturn [new MenuItem({ label: nls.localize('miDownloadingUpdate', \"Downloading Update...\"), enabled: false })];\n\n\t\t\tcase StateType.Downloaded:\n\t\t\t\treturn [new MenuItem({\n\t\t\t\t\tlabel: this.mnemonicLabel(nls.localize('miInstallUpdate', \"Install &&Update...\")), click: () => {\n\t\t\t\t\t\tthis.reportMenuActionTelemetry('InstallUpdate');\n\t\t\t\t\t\tthis.updateService.applyUpdate();\n\t\t\t\t\t}\n\t\t\t\t})];\n\n\t\t\tcase StateType.Updating:\n\t\t\t\treturn [new MenuItem({ label: nls.localize('miInstallingUpdate', \"Installing Update...\"), enabled: false })];\n\n\t\t\tcase StateType.Ready:\n\t\t\t\treturn [new MenuItem({\n\t\t\t\t\tlabel: this.mnemonicLabel(nls.localize('miRestartToUpdate', \"Restart to &&Update\")), click: () => {\n\t\t\t\t\t\tthis.reportMenuActionTelemetry('RestartToUpdate');\n\t\t\t\t\t\tthis.updateService.quitAndInstall();\n\t\t\t\t\t}\n\t\t\t\t})];\n\n\t\t\tdefault:\n\t\t\t\treturn [];\n\t\t}\n\t}\n\n\tprivate createMenuItem(label: string, commandId: string | string[], enabled?: boolean, checked?: boolean): MenuItem;\n\tprivate createMenuItem(label: string, click: () => void, enabled?: boolean, checked?: boolean): MenuItem;\n\tprivate createMenuItem(arg1: string, arg2: any, arg3?: boolean, arg4?: boolean): MenuItem {\n\t\tconst label = this.mnemonicLabel(arg1);\n\t\tconst click: () => void = (typeof arg2 === 'function') ? arg2 : (menuItem: MenuItem & IMenuItemWithKeybinding, win: BrowserWindow, event: KeyboardEvent) => {\n\t\t\tconst userSettingsLabel = menuItem ? menuItem.userSettingsLabel : null;\n\t\t\tlet commandId = arg2;\n\t\t\tif (Array.isArray(arg2)) {\n\t\t\t\tcommandId = this.isOptionClick(event) ? arg2[1] : arg2[0]; // support alternative action if we got multiple action Ids and the option key was pressed while invoking\n\t\t\t}\n\n\t\t\tif (userSettingsLabel && event.triggeredByAccelerator) {\n\t\t\t\tthis.runActionInRenderer({ type: 'keybinding', userSettingsLabel });\n\t\t\t} else {\n\t\t\t\tthis.runActionInRenderer({ type: 'commandId', commandId });\n\t\t\t}\n\t\t};\n\t\tconst enabled = typeof arg3 === 'boolean' ? arg3 : this.windowsMainService.getWindowCount() > 0;\n\t\tconst checked = typeof arg4 === 'boolean' ? arg4 : false;\n\n\t\tconst options: MenuItemConstructorOptions = {\n\t\t\tlabel,\n\t\t\tclick,\n\t\t\tenabled\n\t\t};\n\n\t\tif (checked) {\n\t\t\toptions.type = 'checkbox';\n\t\t\toptions.checked = checked;\n\t\t}\n\n\t\tlet commandId: string | undefined;\n\t\tif (typeof arg2 === 'string') {\n\t\t\tcommandId = arg2;\n\t\t} else if (Array.isArray(arg2)) {\n\t\t\tcommandId = arg2[0];\n\t\t}\n\n\t\tif (isMacintosh) {\n\n\t\t\t// Add role for special case menu items\n\t\t\tif (commandId === 'editor.action.clipboardCutAction') {\n\t\t\t\toptions.role = 'cut';\n\t\t\t} else if (commandId === 'editor.action.clipboardCopyAction') {\n\t\t\t\toptions.role = 'copy';\n\t\t\t} else if (commandId === 'editor.action.clipboardPasteAction') {\n\t\t\t\toptions.role = 'paste';\n\t\t\t}\n\n\t\t\t// Add context aware click handlers for special case menu items\n\t\t\tif (commandId === 'undo') {\n\t\t\t\toptions.click = this.makeContextAwareClickHandler(click, {\n\t\t\t\t\tinDevTools: devTools => devTools.undo(),\n\t\t\t\t\tinNoWindow: () => Menu.sendActionToFirstResponder('undo:')\n\t\t\t\t});\n\t\t\t} else if (commandId === 'redo') {\n\t\t\t\toptions.click = this.makeContextAwareClickHandler(click, {\n\t\t\t\t\tinDevTools: devTools => devTools.redo(),\n\t\t\t\t\tinNoWindow: () => Menu.sendActionToFirstResponder('redo:')\n\t\t\t\t});\n\t\t\t} else if (commandId === 'editor.action.selectAll') {\n\t\t\t\toptions.click = this.makeContextAwareClickHandler(click, {\n\t\t\t\t\tinDevTools: devTools => devTools.selectAll(),\n\t\t\t\t\tinNoWindow: () => Menu.sendActionToFirstResponder('selectAll:')\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\treturn new MenuItem(this.withKeybinding(commandId, options));\n\t}\n\n\tprivate makeContextAwareClickHandler(click: (menuItem: MenuItem, win: BrowserWindow, event: KeyboardEvent) => void, contextSpecificHandlers: IMenuItemClickHandler): (menuItem: MenuItem, win: BrowserWindow | undefined, event: KeyboardEvent) => void {\n\t\treturn (menuItem: MenuItem, win: BrowserWindow | undefined, event: KeyboardEvent) => {\n\n\t\t\t// No Active Window\n\t\t\tconst activeWindow = BrowserWindow.getFocusedWindow();\n\t\t\tif (!activeWindow) {\n\t\t\t\treturn contextSpecificHandlers.inNoWindow();\n\t\t\t}\n\n\t\t\t// DevTools focused\n\t\t\tif (activeWindow.webContents.isDevToolsFocused() &&\n\t\t\t\tactiveWindow.webContents.devToolsWebContents) {\n\t\t\t\treturn contextSpecificHandlers.inDevTools(activeWindow.webContents.devToolsWebContents);\n\t\t\t}\n\n\t\t\t// Finally execute command in Window\n\t\t\tclick(menuItem, win || activeWindow, event);\n\t\t};\n\t}\n\n\tprivate runActionInRenderer(invocation: IMenuItemInvocation): void {\n\t\t// We make sure to not run actions when the window has no focus, this helps\n\t\t// for https://github.com/microsoft/vscode/issues/25907 and specifically for\n\t\t// https://github.com/microsoft/vscode/issues/11928\n\t\t// Still allow to run when the last active window is minimized though for\n\t\t// https://github.com/microsoft/vscode/issues/63000\n\t\tlet activeBrowserWindow = BrowserWindow.getFocusedWindow();\n\t\tif (!activeBrowserWindow) {\n\t\t\tconst lastActiveWindow = this.windowsMainService.getLastActiveWindow();\n\t\t\tif (lastActiveWindow?.isMinimized()) {\n\t\t\t\tactiveBrowserWindow = lastActiveWindow.win;\n\t\t\t}\n\t\t}\n\n\t\tconst activeWindow = activeBrowserWindow ? this.windowsMainService.getWindowById(activeBrowserWindow.id) : undefined;\n\t\tif (activeWindow) {\n\t\t\tthis.logService.trace('menubar#runActionInRenderer', invocation);\n\n\t\t\tif (isMacintosh && !this.environmentMainService.isBuilt && !activeWindow.isReady) {\n\t\t\t\tif ((invocation.type === 'commandId' && invocation.commandId === 'workbench.action.toggleDevTools') || (invocation.type !== 'commandId' && invocation.userSettingsLabel === 'alt+cmd+i')) {\n\t\t\t\t\t// prevent this action from running twice on macOS (https://github.com/microsoft/vscode/issues/62719)\n\t\t\t\t\t// we already register a keybinding in bootstrap-window.js for opening developer tools in case something\n\t\t\t\t\t// goes wrong and that keybinding is only removed when the application has loaded (= window ready).\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (invocation.type === 'commandId') {\n\t\t\t\tconst runActionPayload: INativeRunActionInWindowRequest = { id: invocation.commandId, from: 'menu' };\n\t\t\t\tactiveWindow.sendWhenReady('vscode:runAction', CancellationToken.None, runActionPayload);\n\t\t\t} else {\n\t\t\t\tconst runKeybindingPayload: INativeRunKeybindingInWindowRequest = { userSettingsLabel: invocation.userSettingsLabel };\n\t\t\t\tactiveWindow.sendWhenReady('vscode:runKeybinding', CancellationToken.None, runKeybindingPayload);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.logService.trace('menubar#runActionInRenderer: no active window found', invocation);\n\t\t}\n\t}\n\n\tprivate withKeybinding(commandId: string | undefined, options: MenuItemConstructorOptions & IMenuItemWithKeybinding): MenuItemConstructorOptions {\n\t\tconst binding = typeof commandId === 'string' ? this.keybindings[commandId] : undefined;\n\n\t\t// Apply binding if there is one\n\t\tif (binding?.label) {\n\n\t\t\t// if the binding is native, we can just apply it\n\t\t\tif (binding.isNative !== false) {\n\t\t\t\toptions.accelerator = binding.label;\n\t\t\t\toptions.userSettingsLabel = binding.userSettingsLabel;\n\t\t\t}\n\n\t\t\t// the keybinding is not native so we cannot show it as part of the accelerator of\n\t\t\t// the menu item. we fallback to a different strategy so that we always display it\n\t\t\telse if (typeof options.label === 'string') {\n\t\t\t\tconst bindingIndex = options.label.indexOf('[');\n\t\t\t\tif (bindingIndex >= 0) {\n\t\t\t\t\toptions.label = `${options.label.substr(0, bindingIndex)} [${binding.label}]`;\n\t\t\t\t} else {\n\t\t\t\t\toptions.label = `${options.label} [${binding.label}]`;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Unset bindings if there is none\n\t\telse {\n\t\t\toptions.accelerator = undefined;\n\t\t}\n\n\t\treturn options;\n\t}\n\n\tprivate likeAction(commandId: string, options: MenuItemConstructorOptions, setAccelerator = !options.accelerator): MenuItemConstructorOptions {\n\t\tif (setAccelerator) {\n\t\t\toptions = this.withKeybinding(commandId, options);\n\t\t}\n\n\t\tconst originalClick = options.click;\n\t\toptions.click = (item, window, event) => {\n\t\t\tthis.reportMenuActionTelemetry(commandId);\n\t\t\toriginalClick?.(item, window, event);\n\t\t};\n\n\t\treturn options;\n\t}\n\n\tprivate openUrl(url: string, id: string): void {\n\t\tthis.nativeHostMainService.openExternal(undefined, url);\n\t\tthis.reportMenuActionTelemetry(id);\n\t}\n\n\tprivate reportMenuActionTelemetry(id: string): void {\n\t\tthis.telemetryService.publicLog2<WorkbenchActionExecutedEvent, WorkbenchActionExecutedClassification>('workbenchActionExecuted', { id, from: telemetryFrom });\n\t}\n\n\tprivate mnemonicLabel(label: string): string {\n\t\treturn mnemonicMenuLabel(label, !this.currentEnableMenuBarMnemonics);\n\t}\n}\n\nfunction __separator__(): MenuItem {\n\treturn new MenuItem({ type: 'separator' });\n}\n"]}