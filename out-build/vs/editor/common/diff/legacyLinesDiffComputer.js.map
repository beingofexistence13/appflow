{"version":3,"sources":["file:///workspace/appflow/src/vs/editor/common/diff/legacyLinesDiffComputer.ts"],"names":[],"mappings":"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","file":"legacyLinesDiffComputer.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { CharCode } from 'vs/base/common/charCode';\nimport { IDiffChange, ISequence, LcsDiff, IDiffResult } from 'vs/base/common/diff/diff';\nimport { ILinesDiffComputer, ILinesDiffComputerOptions, LinesDiff } from 'vs/editor/common/diff/linesDiffComputer';\nimport { RangeMapping, DetailedLineRangeMapping } from './rangeMapping';\nimport * as strings from 'vs/base/common/strings';\nimport { Range } from 'vs/editor/common/core/range';\nimport { assertFn, checkAdjacentItems } from 'vs/base/common/assert';\nimport { LineRange } from 'vs/editor/common/core/lineRange';\n\nconst MINIMUM_MATCHING_CHARACTER_LENGTH = 3;\n\nexport class LegacyLinesDiffComputer implements ILinesDiffComputer {\n\tcomputeDiff(originalLines: string[], modifiedLines: string[], options: ILinesDiffComputerOptions): LinesDiff {\n\t\tconst diffComputer = new DiffComputer(originalLines, modifiedLines, {\n\t\t\tmaxComputationTime: options.maxComputationTimeMs,\n\t\t\tshouldIgnoreTrimWhitespace: options.ignoreTrimWhitespace,\n\t\t\tshouldComputeCharChanges: true,\n\t\t\tshouldMakePrettyDiff: true,\n\t\t\tshouldPostProcessCharChanges: true,\n\t\t});\n\t\tconst result = diffComputer.computeDiff();\n\t\tconst changes: DetailedLineRangeMapping[] = [];\n\t\tlet lastChange: DetailedLineRangeMapping | null = null;\n\n\n\t\tfor (const c of result.changes) {\n\t\t\tlet originalRange: LineRange;\n\t\t\tif (c.originalEndLineNumber === 0) {\n\t\t\t\t// Insertion\n\t\t\t\toriginalRange = new LineRange(c.originalStartLineNumber + 1, c.originalStartLineNumber + 1);\n\t\t\t} else {\n\t\t\t\toriginalRange = new LineRange(c.originalStartLineNumber, c.originalEndLineNumber + 1);\n\t\t\t}\n\n\t\t\tlet modifiedRange: LineRange;\n\t\t\tif (c.modifiedEndLineNumber === 0) {\n\t\t\t\t// Deletion\n\t\t\t\tmodifiedRange = new LineRange(c.modifiedStartLineNumber + 1, c.modifiedStartLineNumber + 1);\n\t\t\t} else {\n\t\t\t\tmodifiedRange = new LineRange(c.modifiedStartLineNumber, c.modifiedEndLineNumber + 1);\n\t\t\t}\n\n\t\t\tlet change = new DetailedLineRangeMapping(originalRange, modifiedRange, c.charChanges?.map(c => new RangeMapping(\n\t\t\t\tnew Range(c.originalStartLineNumber, c.originalStartColumn, c.originalEndLineNumber, c.originalEndColumn),\n\t\t\t\tnew Range(c.modifiedStartLineNumber, c.modifiedStartColumn, c.modifiedEndLineNumber, c.modifiedEndColumn),\n\t\t\t)));\n\t\t\tif (lastChange) {\n\t\t\t\tif (lastChange.modified.endLineNumberExclusive === change.modified.startLineNumber\n\t\t\t\t\t|| lastChange.original.endLineNumberExclusive === change.original.startLineNumber) {\n\t\t\t\t\t// join touching diffs. Probably moving diffs up/down in the algorithm causes touching diffs.\n\t\t\t\t\tchange = new DetailedLineRangeMapping(\n\t\t\t\t\t\tlastChange.original.join(change.original),\n\t\t\t\t\t\tlastChange.modified.join(change.modified),\n\t\t\t\t\t\tlastChange.innerChanges && change.innerChanges ?\n\t\t\t\t\t\t\tlastChange.innerChanges.concat(change.innerChanges) : undefined\n\t\t\t\t\t);\n\t\t\t\t\tchanges.pop();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tchanges.push(change);\n\t\t\tlastChange = change;\n\t\t}\n\n\t\tassertFn(() => {\n\t\t\treturn checkAdjacentItems(changes,\n\t\t\t\t(m1, m2) => m2.original.startLineNumber - m1.original.endLineNumberExclusive === m2.modified.startLineNumber - m1.modified.endLineNumberExclusive &&\n\t\t\t\t\t// There has to be an unchanged line in between (otherwise both diffs should have been joined)\n\t\t\t\t\tm1.original.endLineNumberExclusive < m2.original.startLineNumber &&\n\t\t\t\t\tm1.modified.endLineNumberExclusive < m2.modified.startLineNumber,\n\t\t\t);\n\t\t});\n\n\t\treturn new LinesDiff(changes, [], result.quitEarly);\n\t}\n}\n\nexport interface IDiffComputationResult {\n\tquitEarly: boolean;\n\tidentical: boolean;\n\n\t/**\n\t * The changes as (legacy) line change array.\n\t * @deprecated Use `changes2` instead.\n\t */\n\tchanges: ILineChange[];\n\n\t/**\n\t * The changes as (modern) line range mapping array.\n\t */\n\tchanges2: readonly DetailedLineRangeMapping[];\n}\n\n/**\n * A change\n */\nexport interface IChange {\n\treadonly originalStartLineNumber: number;\n\treadonly originalEndLineNumber: number;\n\treadonly modifiedStartLineNumber: number;\n\treadonly modifiedEndLineNumber: number;\n}\n\n/**\n * A character level change.\n */\nexport interface ICharChange extends IChange {\n\treadonly originalStartColumn: number;\n\treadonly originalEndColumn: number;\n\treadonly modifiedStartColumn: number;\n\treadonly modifiedEndColumn: number;\n}\n\n/**\n * A line change\n */\nexport interface ILineChange extends IChange {\n\treadonly charChanges: ICharChange[] | undefined;\n}\n\nexport interface IDiffComputerResult {\n\tquitEarly: boolean;\n\tchanges: ILineChange[];\n}\n\nfunction computeDiff(originalSequence: ISequence, modifiedSequence: ISequence, continueProcessingPredicate: () => boolean, pretty: boolean): IDiffResult {\n\tconst diffAlgo = new LcsDiff(originalSequence, modifiedSequence, continueProcessingPredicate);\n\treturn diffAlgo.ComputeDiff(pretty);\n}\n\nclass LineSequence implements ISequence {\n\n\tpublic readonly lines: string[];\n\tprivate readonly _startColumns: number[];\n\tprivate readonly _endColumns: number[];\n\n\tconstructor(lines: string[]) {\n\t\tconst startColumns: number[] = [];\n\t\tconst endColumns: number[] = [];\n\t\tfor (let i = 0, length = lines.length; i < length; i++) {\n\t\t\tstartColumns[i] = getFirstNonBlankColumn(lines[i], 1);\n\t\t\tendColumns[i] = getLastNonBlankColumn(lines[i], 1);\n\t\t}\n\t\tthis.lines = lines;\n\t\tthis._startColumns = startColumns;\n\t\tthis._endColumns = endColumns;\n\t}\n\n\tpublic getElements(): Int32Array | number[] | string[] {\n\t\tconst elements: string[] = [];\n\t\tfor (let i = 0, len = this.lines.length; i < len; i++) {\n\t\t\telements[i] = this.lines[i].substring(this._startColumns[i] - 1, this._endColumns[i] - 1);\n\t\t}\n\t\treturn elements;\n\t}\n\n\tpublic getStrictElement(index: number): string {\n\t\treturn this.lines[index];\n\t}\n\n\tpublic getStartLineNumber(i: number): number {\n\t\treturn i + 1;\n\t}\n\n\tpublic getEndLineNumber(i: number): number {\n\t\treturn i + 1;\n\t}\n\n\tpublic createCharSequence(shouldIgnoreTrimWhitespace: boolean, startIndex: number, endIndex: number): CharSequence {\n\t\tconst charCodes: number[] = [];\n\t\tconst lineNumbers: number[] = [];\n\t\tconst columns: number[] = [];\n\t\tlet len = 0;\n\t\tfor (let index = startIndex; index <= endIndex; index++) {\n\t\t\tconst lineContent = this.lines[index];\n\t\t\tconst startColumn = (shouldIgnoreTrimWhitespace ? this._startColumns[index] : 1);\n\t\t\tconst endColumn = (shouldIgnoreTrimWhitespace ? this._endColumns[index] : lineContent.length + 1);\n\t\t\tfor (let col = startColumn; col < endColumn; col++) {\n\t\t\t\tcharCodes[len] = lineContent.charCodeAt(col - 1);\n\t\t\t\tlineNumbers[len] = index + 1;\n\t\t\t\tcolumns[len] = col;\n\t\t\t\tlen++;\n\t\t\t}\n\t\t\tif (!shouldIgnoreTrimWhitespace && index < endIndex) {\n\t\t\t\t// Add \\n if trim whitespace is not ignored\n\t\t\t\tcharCodes[len] = CharCode.LineFeed;\n\t\t\t\tlineNumbers[len] = index + 1;\n\t\t\t\tcolumns[len] = lineContent.length + 1;\n\t\t\t\tlen++;\n\t\t\t}\n\t\t}\n\t\treturn new CharSequence(charCodes, lineNumbers, columns);\n\t}\n}\n\nclass CharSequence implements ISequence {\n\n\tprivate readonly _charCodes: number[];\n\tprivate readonly _lineNumbers: number[];\n\tprivate readonly _columns: number[];\n\n\tconstructor(charCodes: number[], lineNumbers: number[], columns: number[]) {\n\t\tthis._charCodes = charCodes;\n\t\tthis._lineNumbers = lineNumbers;\n\t\tthis._columns = columns;\n\t}\n\n\tpublic toString() {\n\t\treturn (\n\t\t\t'[' + this._charCodes.map((s, idx) => (s === CharCode.LineFeed ? '\\\\n' : String.fromCharCode(s)) + `-(${this._lineNumbers[idx]},${this._columns[idx]})`).join(', ') + ']'\n\t\t);\n\t}\n\n\tprivate _assertIndex(index: number, arr: number[]): void {\n\t\tif (index < 0 || index >= arr.length) {\n\t\t\tthrow new Error(`Illegal index`);\n\t\t}\n\t}\n\n\tpublic getElements(): Int32Array | number[] | string[] {\n\t\treturn this._charCodes;\n\t}\n\n\tpublic getStartLineNumber(i: number): number {\n\t\tif (i > 0 && i === this._lineNumbers.length) {\n\t\t\t// the start line number of the element after the last element\n\t\t\t// is the end line number of the last element\n\t\t\treturn this.getEndLineNumber(i - 1);\n\t\t}\n\t\tthis._assertIndex(i, this._lineNumbers);\n\n\t\treturn this._lineNumbers[i];\n\t}\n\n\tpublic getEndLineNumber(i: number): number {\n\t\tif (i === -1) {\n\t\t\t// the end line number of the element before the first element\n\t\t\t// is the start line number of the first element\n\t\t\treturn this.getStartLineNumber(i + 1);\n\t\t}\n\t\tthis._assertIndex(i, this._lineNumbers);\n\n\t\tif (this._charCodes[i] === CharCode.LineFeed) {\n\t\t\treturn this._lineNumbers[i] + 1;\n\t\t}\n\t\treturn this._lineNumbers[i];\n\t}\n\n\tpublic getStartColumn(i: number): number {\n\t\tif (i > 0 && i === this._columns.length) {\n\t\t\t// the start column of the element after the last element\n\t\t\t// is the end column of the last element\n\t\t\treturn this.getEndColumn(i - 1);\n\t\t}\n\t\tthis._assertIndex(i, this._columns);\n\t\treturn this._columns[i];\n\t}\n\n\tpublic getEndColumn(i: number): number {\n\t\tif (i === -1) {\n\t\t\t// the end column of the element before the first element\n\t\t\t// is the start column of the first element\n\t\t\treturn this.getStartColumn(i + 1);\n\t\t}\n\t\tthis._assertIndex(i, this._columns);\n\n\t\tif (this._charCodes[i] === CharCode.LineFeed) {\n\t\t\treturn 1;\n\t\t}\n\t\treturn this._columns[i] + 1;\n\t}\n}\n\nclass CharChange implements ICharChange {\n\n\tpublic originalStartLineNumber: number;\n\tpublic originalStartColumn: number;\n\tpublic originalEndLineNumber: number;\n\tpublic originalEndColumn: number;\n\n\tpublic modifiedStartLineNumber: number;\n\tpublic modifiedStartColumn: number;\n\tpublic modifiedEndLineNumber: number;\n\tpublic modifiedEndColumn: number;\n\n\tconstructor(\n\t\toriginalStartLineNumber: number,\n\t\toriginalStartColumn: number,\n\t\toriginalEndLineNumber: number,\n\t\toriginalEndColumn: number,\n\t\tmodifiedStartLineNumber: number,\n\t\tmodifiedStartColumn: number,\n\t\tmodifiedEndLineNumber: number,\n\t\tmodifiedEndColumn: number\n\t) {\n\t\tthis.originalStartLineNumber = originalStartLineNumber;\n\t\tthis.originalStartColumn = originalStartColumn;\n\t\tthis.originalEndLineNumber = originalEndLineNumber;\n\t\tthis.originalEndColumn = originalEndColumn;\n\t\tthis.modifiedStartLineNumber = modifiedStartLineNumber;\n\t\tthis.modifiedStartColumn = modifiedStartColumn;\n\t\tthis.modifiedEndLineNumber = modifiedEndLineNumber;\n\t\tthis.modifiedEndColumn = modifiedEndColumn;\n\t}\n\n\tpublic static createFromDiffChange(diffChange: IDiffChange, originalCharSequence: CharSequence, modifiedCharSequence: CharSequence): CharChange {\n\t\tconst originalStartLineNumber = originalCharSequence.getStartLineNumber(diffChange.originalStart);\n\t\tconst originalStartColumn = originalCharSequence.getStartColumn(diffChange.originalStart);\n\t\tconst originalEndLineNumber = originalCharSequence.getEndLineNumber(diffChange.originalStart + diffChange.originalLength - 1);\n\t\tconst originalEndColumn = originalCharSequence.getEndColumn(diffChange.originalStart + diffChange.originalLength - 1);\n\n\t\tconst modifiedStartLineNumber = modifiedCharSequence.getStartLineNumber(diffChange.modifiedStart);\n\t\tconst modifiedStartColumn = modifiedCharSequence.getStartColumn(diffChange.modifiedStart);\n\t\tconst modifiedEndLineNumber = modifiedCharSequence.getEndLineNumber(diffChange.modifiedStart + diffChange.modifiedLength - 1);\n\t\tconst modifiedEndColumn = modifiedCharSequence.getEndColumn(diffChange.modifiedStart + diffChange.modifiedLength - 1);\n\n\t\treturn new CharChange(\n\t\t\toriginalStartLineNumber, originalStartColumn, originalEndLineNumber, originalEndColumn,\n\t\t\tmodifiedStartLineNumber, modifiedStartColumn, modifiedEndLineNumber, modifiedEndColumn,\n\t\t);\n\t}\n}\n\nfunction postProcessCharChanges(rawChanges: IDiffChange[]): IDiffChange[] {\n\tif (rawChanges.length <= 1) {\n\t\treturn rawChanges;\n\t}\n\n\tconst result = [rawChanges[0]];\n\tlet prevChange = result[0];\n\n\tfor (let i = 1, len = rawChanges.length; i < len; i++) {\n\t\tconst currChange = rawChanges[i];\n\n\t\tconst originalMatchingLength = currChange.originalStart - (prevChange.originalStart + prevChange.originalLength);\n\t\tconst modifiedMatchingLength = currChange.modifiedStart - (prevChange.modifiedStart + prevChange.modifiedLength);\n\t\t// Both of the above should be equal, but the continueProcessingPredicate may prevent this from being true\n\t\tconst matchingLength = Math.min(originalMatchingLength, modifiedMatchingLength);\n\n\t\tif (matchingLength < MINIMUM_MATCHING_CHARACTER_LENGTH) {\n\t\t\t// Merge the current change into the previous one\n\t\t\tprevChange.originalLength = (currChange.originalStart + currChange.originalLength) - prevChange.originalStart;\n\t\t\tprevChange.modifiedLength = (currChange.modifiedStart + currChange.modifiedLength) - prevChange.modifiedStart;\n\t\t} else {\n\t\t\t// Add the current change\n\t\t\tresult.push(currChange);\n\t\t\tprevChange = currChange;\n\t\t}\n\t}\n\n\treturn result;\n}\n\nclass LineChange implements ILineChange {\n\tpublic originalStartLineNumber: number;\n\tpublic originalEndLineNumber: number;\n\tpublic modifiedStartLineNumber: number;\n\tpublic modifiedEndLineNumber: number;\n\tpublic charChanges: CharChange[] | undefined;\n\n\tconstructor(\n\t\toriginalStartLineNumber: number,\n\t\toriginalEndLineNumber: number,\n\t\tmodifiedStartLineNumber: number,\n\t\tmodifiedEndLineNumber: number,\n\t\tcharChanges: CharChange[] | undefined\n\t) {\n\t\tthis.originalStartLineNumber = originalStartLineNumber;\n\t\tthis.originalEndLineNumber = originalEndLineNumber;\n\t\tthis.modifiedStartLineNumber = modifiedStartLineNumber;\n\t\tthis.modifiedEndLineNumber = modifiedEndLineNumber;\n\t\tthis.charChanges = charChanges;\n\t}\n\n\tpublic static createFromDiffResult(shouldIgnoreTrimWhitespace: boolean, diffChange: IDiffChange, originalLineSequence: LineSequence, modifiedLineSequence: LineSequence, continueCharDiff: () => boolean, shouldComputeCharChanges: boolean, shouldPostProcessCharChanges: boolean): LineChange {\n\t\tlet originalStartLineNumber: number;\n\t\tlet originalEndLineNumber: number;\n\t\tlet modifiedStartLineNumber: number;\n\t\tlet modifiedEndLineNumber: number;\n\t\tlet charChanges: CharChange[] | undefined = undefined;\n\n\t\tif (diffChange.originalLength === 0) {\n\t\t\toriginalStartLineNumber = originalLineSequence.getStartLineNumber(diffChange.originalStart) - 1;\n\t\t\toriginalEndLineNumber = 0;\n\t\t} else {\n\t\t\toriginalStartLineNumber = originalLineSequence.getStartLineNumber(diffChange.originalStart);\n\t\t\toriginalEndLineNumber = originalLineSequence.getEndLineNumber(diffChange.originalStart + diffChange.originalLength - 1);\n\t\t}\n\n\t\tif (diffChange.modifiedLength === 0) {\n\t\t\tmodifiedStartLineNumber = modifiedLineSequence.getStartLineNumber(diffChange.modifiedStart) - 1;\n\t\t\tmodifiedEndLineNumber = 0;\n\t\t} else {\n\t\t\tmodifiedStartLineNumber = modifiedLineSequence.getStartLineNumber(diffChange.modifiedStart);\n\t\t\tmodifiedEndLineNumber = modifiedLineSequence.getEndLineNumber(diffChange.modifiedStart + diffChange.modifiedLength - 1);\n\t\t}\n\n\t\tif (shouldComputeCharChanges && diffChange.originalLength > 0 && diffChange.originalLength < 20 && diffChange.modifiedLength > 0 && diffChange.modifiedLength < 20 && continueCharDiff()) {\n\t\t\t// Compute character changes for diff chunks of at most 20 lines...\n\t\t\tconst originalCharSequence = originalLineSequence.createCharSequence(shouldIgnoreTrimWhitespace, diffChange.originalStart, diffChange.originalStart + diffChange.originalLength - 1);\n\t\t\tconst modifiedCharSequence = modifiedLineSequence.createCharSequence(shouldIgnoreTrimWhitespace, diffChange.modifiedStart, diffChange.modifiedStart + diffChange.modifiedLength - 1);\n\n\t\t\tif (originalCharSequence.getElements().length > 0 && modifiedCharSequence.getElements().length > 0) {\n\t\t\t\tlet rawChanges = computeDiff(originalCharSequence, modifiedCharSequence, continueCharDiff, true).changes;\n\n\t\t\t\tif (shouldPostProcessCharChanges) {\n\t\t\t\t\trawChanges = postProcessCharChanges(rawChanges);\n\t\t\t\t}\n\n\t\t\t\tcharChanges = [];\n\t\t\t\tfor (let i = 0, length = rawChanges.length; i < length; i++) {\n\t\t\t\t\tcharChanges.push(CharChange.createFromDiffChange(rawChanges[i], originalCharSequence, modifiedCharSequence));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn new LineChange(originalStartLineNumber, originalEndLineNumber, modifiedStartLineNumber, modifiedEndLineNumber, charChanges);\n\t}\n}\n\nexport interface IDiffComputerOpts {\n\tshouldComputeCharChanges: boolean;\n\tshouldPostProcessCharChanges: boolean;\n\tshouldIgnoreTrimWhitespace: boolean;\n\tshouldMakePrettyDiff: boolean;\n\tmaxComputationTime: number;\n}\n\nexport class DiffComputer {\n\n\tprivate readonly shouldComputeCharChanges: boolean;\n\tprivate readonly shouldPostProcessCharChanges: boolean;\n\tprivate readonly shouldIgnoreTrimWhitespace: boolean;\n\tprivate readonly shouldMakePrettyDiff: boolean;\n\tprivate readonly originalLines: string[];\n\tprivate readonly modifiedLines: string[];\n\tprivate readonly original: LineSequence;\n\tprivate readonly modified: LineSequence;\n\tprivate readonly continueLineDiff: () => boolean;\n\tprivate readonly continueCharDiff: () => boolean;\n\n\tconstructor(originalLines: string[], modifiedLines: string[], opts: IDiffComputerOpts) {\n\t\tthis.shouldComputeCharChanges = opts.shouldComputeCharChanges;\n\t\tthis.shouldPostProcessCharChanges = opts.shouldPostProcessCharChanges;\n\t\tthis.shouldIgnoreTrimWhitespace = opts.shouldIgnoreTrimWhitespace;\n\t\tthis.shouldMakePrettyDiff = opts.shouldMakePrettyDiff;\n\t\tthis.originalLines = originalLines;\n\t\tthis.modifiedLines = modifiedLines;\n\t\tthis.original = new LineSequence(originalLines);\n\t\tthis.modified = new LineSequence(modifiedLines);\n\n\t\tthis.continueLineDiff = createContinueProcessingPredicate(opts.maxComputationTime);\n\t\tthis.continueCharDiff = createContinueProcessingPredicate(opts.maxComputationTime === 0 ? 0 : Math.min(opts.maxComputationTime, 5000)); // never run after 5s for character changes...\n\t}\n\n\tpublic computeDiff(): IDiffComputerResult {\n\n\t\tif (this.original.lines.length === 1 && this.original.lines[0].length === 0) {\n\t\t\t// empty original => fast path\n\t\t\tif (this.modified.lines.length === 1 && this.modified.lines[0].length === 0) {\n\t\t\t\treturn {\n\t\t\t\t\tquitEarly: false,\n\t\t\t\t\tchanges: []\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tquitEarly: false,\n\t\t\t\tchanges: [{\n\t\t\t\t\toriginalStartLineNumber: 1,\n\t\t\t\t\toriginalEndLineNumber: 1,\n\t\t\t\t\tmodifiedStartLineNumber: 1,\n\t\t\t\t\tmodifiedEndLineNumber: this.modified.lines.length,\n\t\t\t\t\tcharChanges: undefined\n\t\t\t\t}]\n\t\t\t};\n\t\t}\n\n\t\tif (this.modified.lines.length === 1 && this.modified.lines[0].length === 0) {\n\t\t\t// empty modified => fast path\n\t\t\treturn {\n\t\t\t\tquitEarly: false,\n\t\t\t\tchanges: [{\n\t\t\t\t\toriginalStartLineNumber: 1,\n\t\t\t\t\toriginalEndLineNumber: this.original.lines.length,\n\t\t\t\t\tmodifiedStartLineNumber: 1,\n\t\t\t\t\tmodifiedEndLineNumber: 1,\n\t\t\t\t\tcharChanges: undefined\n\t\t\t\t}]\n\t\t\t};\n\t\t}\n\n\t\tconst diffResult = computeDiff(this.original, this.modified, this.continueLineDiff, this.shouldMakePrettyDiff);\n\t\tconst rawChanges = diffResult.changes;\n\t\tconst quitEarly = diffResult.quitEarly;\n\n\t\t// The diff is always computed with ignoring trim whitespace\n\t\t// This ensures we get the prettiest diff\n\n\t\tif (this.shouldIgnoreTrimWhitespace) {\n\t\t\tconst lineChanges: LineChange[] = [];\n\t\t\tfor (let i = 0, length = rawChanges.length; i < length; i++) {\n\t\t\t\tlineChanges.push(LineChange.createFromDiffResult(this.shouldIgnoreTrimWhitespace, rawChanges[i], this.original, this.modified, this.continueCharDiff, this.shouldComputeCharChanges, this.shouldPostProcessCharChanges));\n\t\t\t}\n\t\t\treturn {\n\t\t\t\tquitEarly: quitEarly,\n\t\t\t\tchanges: lineChanges\n\t\t\t};\n\t\t}\n\n\t\t// Need to post-process and introduce changes where the trim whitespace is different\n\t\t// Note that we are looping starting at -1 to also cover the lines before the first change\n\t\tconst result: LineChange[] = [];\n\n\t\tlet originalLineIndex = 0;\n\t\tlet modifiedLineIndex = 0;\n\t\tfor (let i = -1 /* !!!! */, len = rawChanges.length; i < len; i++) {\n\t\t\tconst nextChange = (i + 1 < len ? rawChanges[i + 1] : null);\n\t\t\tconst originalStop = (nextChange ? nextChange.originalStart : this.originalLines.length);\n\t\t\tconst modifiedStop = (nextChange ? nextChange.modifiedStart : this.modifiedLines.length);\n\n\t\t\twhile (originalLineIndex < originalStop && modifiedLineIndex < modifiedStop) {\n\t\t\t\tconst originalLine = this.originalLines[originalLineIndex];\n\t\t\t\tconst modifiedLine = this.modifiedLines[modifiedLineIndex];\n\n\t\t\t\tif (originalLine !== modifiedLine) {\n\t\t\t\t\t// These lines differ only in trim whitespace\n\n\t\t\t\t\t// Check the leading whitespace\n\t\t\t\t\t{\n\t\t\t\t\t\tlet originalStartColumn = getFirstNonBlankColumn(originalLine, 1);\n\t\t\t\t\t\tlet modifiedStartColumn = getFirstNonBlankColumn(modifiedLine, 1);\n\t\t\t\t\t\twhile (originalStartColumn > 1 && modifiedStartColumn > 1) {\n\t\t\t\t\t\t\tconst originalChar = originalLine.charCodeAt(originalStartColumn - 2);\n\t\t\t\t\t\t\tconst modifiedChar = modifiedLine.charCodeAt(modifiedStartColumn - 2);\n\t\t\t\t\t\t\tif (originalChar !== modifiedChar) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\toriginalStartColumn--;\n\t\t\t\t\t\t\tmodifiedStartColumn--;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (originalStartColumn > 1 || modifiedStartColumn > 1) {\n\t\t\t\t\t\t\tthis._pushTrimWhitespaceCharChange(result,\n\t\t\t\t\t\t\t\toriginalLineIndex + 1, 1, originalStartColumn,\n\t\t\t\t\t\t\t\tmodifiedLineIndex + 1, 1, modifiedStartColumn\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Check the trailing whitespace\n\t\t\t\t\t{\n\t\t\t\t\t\tlet originalEndColumn = getLastNonBlankColumn(originalLine, 1);\n\t\t\t\t\t\tlet modifiedEndColumn = getLastNonBlankColumn(modifiedLine, 1);\n\t\t\t\t\t\tconst originalMaxColumn = originalLine.length + 1;\n\t\t\t\t\t\tconst modifiedMaxColumn = modifiedLine.length + 1;\n\t\t\t\t\t\twhile (originalEndColumn < originalMaxColumn && modifiedEndColumn < modifiedMaxColumn) {\n\t\t\t\t\t\t\tconst originalChar = originalLine.charCodeAt(originalEndColumn - 1);\n\t\t\t\t\t\t\tconst modifiedChar = originalLine.charCodeAt(modifiedEndColumn - 1);\n\t\t\t\t\t\t\tif (originalChar !== modifiedChar) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\toriginalEndColumn++;\n\t\t\t\t\t\t\tmodifiedEndColumn++;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (originalEndColumn < originalMaxColumn || modifiedEndColumn < modifiedMaxColumn) {\n\t\t\t\t\t\t\tthis._pushTrimWhitespaceCharChange(result,\n\t\t\t\t\t\t\t\toriginalLineIndex + 1, originalEndColumn, originalMaxColumn,\n\t\t\t\t\t\t\t\tmodifiedLineIndex + 1, modifiedEndColumn, modifiedMaxColumn\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\toriginalLineIndex++;\n\t\t\t\tmodifiedLineIndex++;\n\t\t\t}\n\n\t\t\tif (nextChange) {\n\t\t\t\t// Emit the actual change\n\t\t\t\tresult.push(LineChange.createFromDiffResult(this.shouldIgnoreTrimWhitespace, nextChange, this.original, this.modified, this.continueCharDiff, this.shouldComputeCharChanges, this.shouldPostProcessCharChanges));\n\n\t\t\t\toriginalLineIndex += nextChange.originalLength;\n\t\t\t\tmodifiedLineIndex += nextChange.modifiedLength;\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\tquitEarly: quitEarly,\n\t\t\tchanges: result\n\t\t};\n\t}\n\n\tprivate _pushTrimWhitespaceCharChange(\n\t\tresult: LineChange[],\n\t\toriginalLineNumber: number, originalStartColumn: number, originalEndColumn: number,\n\t\tmodifiedLineNumber: number, modifiedStartColumn: number, modifiedEndColumn: number\n\t): void {\n\t\tif (this._mergeTrimWhitespaceCharChange(result, originalLineNumber, originalStartColumn, originalEndColumn, modifiedLineNumber, modifiedStartColumn, modifiedEndColumn)) {\n\t\t\t// Merged into previous\n\t\t\treturn;\n\t\t}\n\n\t\tlet charChanges: CharChange[] | undefined = undefined;\n\t\tif (this.shouldComputeCharChanges) {\n\t\t\tcharChanges = [new CharChange(\n\t\t\t\toriginalLineNumber, originalStartColumn, originalLineNumber, originalEndColumn,\n\t\t\t\tmodifiedLineNumber, modifiedStartColumn, modifiedLineNumber, modifiedEndColumn\n\t\t\t)];\n\t\t}\n\t\tresult.push(new LineChange(\n\t\t\toriginalLineNumber, originalLineNumber,\n\t\t\tmodifiedLineNumber, modifiedLineNumber,\n\t\t\tcharChanges\n\t\t));\n\t}\n\n\tprivate _mergeTrimWhitespaceCharChange(\n\t\tresult: LineChange[],\n\t\toriginalLineNumber: number, originalStartColumn: number, originalEndColumn: number,\n\t\tmodifiedLineNumber: number, modifiedStartColumn: number, modifiedEndColumn: number\n\t): boolean {\n\t\tconst len = result.length;\n\t\tif (len === 0) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst prevChange = result[len - 1];\n\n\t\tif (prevChange.originalEndLineNumber === 0 || prevChange.modifiedEndLineNumber === 0) {\n\t\t\t// Don't merge with inserts/deletes\n\t\t\treturn false;\n\t\t}\n\n\t\tif (prevChange.originalEndLineNumber === originalLineNumber && prevChange.modifiedEndLineNumber === modifiedLineNumber) {\n\t\t\tif (this.shouldComputeCharChanges && prevChange.charChanges) {\n\t\t\t\tprevChange.charChanges.push(new CharChange(\n\t\t\t\t\toriginalLineNumber, originalStartColumn, originalLineNumber, originalEndColumn,\n\t\t\t\t\tmodifiedLineNumber, modifiedStartColumn, modifiedLineNumber, modifiedEndColumn\n\t\t\t\t));\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\n\t\tif (prevChange.originalEndLineNumber + 1 === originalLineNumber && prevChange.modifiedEndLineNumber + 1 === modifiedLineNumber) {\n\t\t\tprevChange.originalEndLineNumber = originalLineNumber;\n\t\t\tprevChange.modifiedEndLineNumber = modifiedLineNumber;\n\t\t\tif (this.shouldComputeCharChanges && prevChange.charChanges) {\n\t\t\t\tprevChange.charChanges.push(new CharChange(\n\t\t\t\t\toriginalLineNumber, originalStartColumn, originalLineNumber, originalEndColumn,\n\t\t\t\t\tmodifiedLineNumber, modifiedStartColumn, modifiedLineNumber, modifiedEndColumn\n\t\t\t\t));\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n}\n\nfunction getFirstNonBlankColumn(txt: string, defaultValue: number): number {\n\tconst r = strings.firstNonWhitespaceIndex(txt);\n\tif (r === -1) {\n\t\treturn defaultValue;\n\t}\n\treturn r + 1;\n}\n\nfunction getLastNonBlankColumn(txt: string, defaultValue: number): number {\n\tconst r = strings.lastNonWhitespaceIndex(txt);\n\tif (r === -1) {\n\t\treturn defaultValue;\n\t}\n\treturn r + 2;\n}\n\nfunction createContinueProcessingPredicate(maximumRuntime: number): () => boolean {\n\tif (maximumRuntime === 0) {\n\t\treturn () => true;\n\t}\n\n\tconst startTime = Date.now();\n\treturn () => {\n\t\treturn Date.now() - startTime < maximumRuntime;\n\t};\n}\n"]}