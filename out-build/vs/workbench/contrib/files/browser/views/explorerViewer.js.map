{"version":3,"sources":["vs/workbench/contrib/files/browser/views/explorerViewer.ts"],"names":[],"mappings":"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","file":"explorerViewer.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IListAccessibilityProvider } from 'vs/base/browser/ui/list/listWidget';\nimport * as DOM from 'vs/base/browser/dom';\nimport * as glob from 'vs/base/common/glob';\nimport { IListVirtualDelegate, ListDragOverEffect } from 'vs/base/browser/ui/list/list';\nimport { IProgressService, ProgressLocation, } from 'vs/platform/progress/common/progress';\nimport { INotificationService, Severity } from 'vs/platform/notification/common/notification';\nimport { IFileService, FileKind, FileOperationError, FileOperationResult, FileChangeType } from 'vs/platform/files/common/files';\nimport { IWorkbenchLayoutService } from 'vs/workbench/services/layout/browser/layoutService';\nimport { isTemporaryWorkspace, IWorkspaceContextService, WorkbenchState } from 'vs/platform/workspace/common/workspace';\nimport { IDisposable, Disposable, dispose, toDisposable, DisposableStore } from 'vs/base/common/lifecycle';\nimport { KeyCode } from 'vs/base/common/keyCodes';\nimport { IFileLabelOptions, IResourceLabel, ResourceLabels } from 'vs/workbench/browser/labels';\nimport { ITreeNode, ITreeFilter, TreeVisibility, IAsyncDataSource, ITreeSorter, ITreeDragAndDrop, ITreeDragOverReaction, TreeDragOverBubble } from 'vs/base/browser/ui/tree/tree';\nimport { IContextMenuService, IContextViewService } from 'vs/platform/contextview/browser/contextView';\nimport { IThemeService } from 'vs/platform/theme/common/themeService';\nimport { IConfigurationChangeEvent, IConfigurationService } from 'vs/platform/configuration/common/configuration';\nimport { IFilesConfiguration, UndoConfirmLevel } from 'vs/workbench/contrib/files/common/files';\nimport { dirname, joinPath, distinctParents } from 'vs/base/common/resources';\nimport { InputBox, MessageType } from 'vs/base/browser/ui/inputbox/inputBox';\nimport { localize } from 'vs/nls';\nimport { once } from 'vs/base/common/functional';\nimport { IKeyboardEvent } from 'vs/base/browser/keyboardEvent';\nimport { equals, deepClone } from 'vs/base/common/objects';\nimport * as path from 'vs/base/common/path';\nimport { ExplorerItem, NewExplorerItem } from 'vs/workbench/contrib/files/common/explorerModel';\nimport { compareFileExtensionsDefault, compareFileNamesDefault, compareFileNamesUpper, compareFileExtensionsUpper, compareFileNamesLower, compareFileExtensionsLower, compareFileNamesUnicode, compareFileExtensionsUnicode } from 'vs/base/common/comparers';\nimport { CodeDataTransfers, containsDragType } from 'vs/platform/dnd/browser/dnd';\nimport { fillEditorsDragData } from 'vs/workbench/browser/dnd';\nimport { IInstantiationService } from 'vs/platform/instantiation/common/instantiation';\nimport { IDragAndDropData, DataTransfers } from 'vs/base/browser/dnd';\nimport { Schemas } from 'vs/base/common/network';\nimport { NativeDragAndDropData, ExternalElementsDragAndDropData, ElementsDragAndDropData } from 'vs/base/browser/ui/list/listView';\nimport { isMacintosh, isWeb } from 'vs/base/common/platform';\nimport { IDialogService, getFileNamesMessage } from 'vs/platform/dialogs/common/dialogs';\nimport { IWorkspaceEditingService } from 'vs/workbench/services/workspaces/common/workspaceEditing';\nimport { URI } from 'vs/base/common/uri';\nimport { IEditorService } from 'vs/workbench/services/editor/common/editorService';\nimport { IWorkspaceFolderCreationData } from 'vs/platform/workspaces/common/workspaces';\nimport { findValidPasteFileTarget } from 'vs/workbench/contrib/files/browser/fileActions';\nimport { FuzzyScore, createMatches } from 'vs/base/common/filters';\nimport { Emitter, Event, EventMultiplexer } from 'vs/base/common/event';\nimport { ITreeCompressionDelegate } from 'vs/base/browser/ui/tree/asyncDataTree';\nimport { ICompressibleTreeRenderer } from 'vs/base/browser/ui/tree/objectTree';\nimport { ICompressedTreeNode } from 'vs/base/browser/ui/tree/compressedObjectTreeModel';\nimport { ILabelService } from 'vs/platform/label/common/label';\nimport { isNumber, isStringArray } from 'vs/base/common/types';\nimport { IEditableData } from 'vs/workbench/common/views';\nimport { EditorInput } from 'vs/workbench/common/editor/editorInput';\nimport { IUriIdentityService } from 'vs/platform/uriIdentity/common/uriIdentity';\nimport { ResourceFileEdit } from 'vs/editor/browser/services/bulkEditService';\nimport { IExplorerService } from 'vs/workbench/contrib/files/browser/files';\nimport { BrowserFileUpload, ExternalFileImport, getMultipleFilesOverwriteConfirm } from 'vs/workbench/contrib/files/browser/fileImportExport';\nimport { toErrorMessage } from 'vs/base/common/errorMessage';\nimport { WebFileSystemAccess } from 'vs/platform/files/browser/webFileSystemAccess';\nimport { IgnoreFile } from 'vs/workbench/services/search/common/ignoreFile';\nimport { ResourceSet } from 'vs/base/common/map';\nimport { TernarySearchTree } from 'vs/base/common/ternarySearchTree';\nimport { defaultInputBoxStyles } from 'vs/platform/theme/browser/defaultStyles';\nimport { timeout } from 'vs/base/common/async';\nimport { IHoverDelegate, IHoverDelegateOptions, IHoverWidget } from 'vs/base/browser/ui/iconLabel/iconHoverDelegate';\nimport { IHoverService } from 'vs/workbench/services/hover/browser/hover';\nimport { HoverPosition } from 'vs/base/browser/ui/hover/hoverWidget';\nimport { IFilesConfigurationService } from 'vs/workbench/services/filesConfiguration/common/filesConfigurationService';\n\nexport class ExplorerDelegate implements IListVirtualDelegate<ExplorerItem> {\n\n\tstatic readonly ITEM_HEIGHT = 22;\n\n\tgetHeight(element: ExplorerItem): number {\n\t\treturn ExplorerDelegate.ITEM_HEIGHT;\n\t}\n\n\tgetTemplateId(element: ExplorerItem): string {\n\t\treturn FilesRenderer.ID;\n\t}\n}\n\nexport const explorerRootErrorEmitter = new Emitter<URI>();\nexport class ExplorerDataSource implements IAsyncDataSource<ExplorerItem | ExplorerItem[], ExplorerItem> {\n\n\tconstructor(\n\t\tprivate fileFilter: FilesFilter,\n\t\t@IProgressService private readonly progressService: IProgressService,\n\t\t@IConfigurationService private readonly configService: IConfigurationService,\n\t\t@INotificationService private readonly notificationService: INotificationService,\n\t\t@IWorkbenchLayoutService private readonly layoutService: IWorkbenchLayoutService,\n\t\t@IFileService private readonly fileService: IFileService,\n\t\t@IExplorerService private readonly explorerService: IExplorerService,\n\t\t@IWorkspaceContextService private readonly contextService: IWorkspaceContextService,\n\t\t@IFilesConfigurationService private readonly filesConfigService: IFilesConfigurationService\n\t) { }\n\n\thasChildren(element: ExplorerItem | ExplorerItem[]): boolean {\n\t\t// don't render nest parents as containing children when all the children are filtered out\n\t\treturn Array.isArray(element) || element.hasChildren((stat) => this.fileFilter.filter(stat, TreeVisibility.Visible));\n\t}\n\n\tgetChildren(element: ExplorerItem | ExplorerItem[]): ExplorerItem[] | Promise<ExplorerItem[]> {\n\t\tif (Array.isArray(element)) {\n\t\t\treturn element;\n\t\t}\n\n\t\tconst hasError = element.error;\n\t\tconst sortOrder = this.explorerService.sortOrderConfiguration.sortOrder;\n\t\tconst children = element.fetchChildren(sortOrder);\n\t\tif (Array.isArray(children)) {\n\t\t\t// fast path when children are known sync (i.e. nested children)\n\t\t\treturn children;\n\t\t}\n\t\tconst promise = children.then(\n\t\t\tchildren => {\n\t\t\t\t// Clear previous error decoration on root folder\n\t\t\t\tif (element instanceof ExplorerItem && element.isRoot && !element.error && hasError && this.contextService.getWorkbenchState() !== WorkbenchState.FOLDER) {\n\t\t\t\t\texplorerRootErrorEmitter.fire(element.resource);\n\t\t\t\t}\n\t\t\t\treturn children;\n\t\t\t}\n\t\t\t, e => {\n\n\t\t\t\tif (element instanceof ExplorerItem && element.isRoot) {\n\t\t\t\t\tif (this.contextService.getWorkbenchState() === WorkbenchState.FOLDER) {\n\t\t\t\t\t\t// Single folder create a dummy explorer item to show error\n\t\t\t\t\t\tconst placeholder = new ExplorerItem(element.resource, this.fileService, this.configService, this.filesConfigService, undefined, undefined, false);\n\t\t\t\t\t\tplaceholder.error = e;\n\t\t\t\t\t\treturn [placeholder];\n\t\t\t\t\t} else {\n\t\t\t\t\t\texplorerRootErrorEmitter.fire(element.resource);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// Do not show error for roots since we already use an explorer decoration to notify user\n\t\t\t\t\tthis.notificationService.error(e);\n\t\t\t\t}\n\n\t\t\t\treturn []; // we could not resolve any children because of an error\n\t\t\t});\n\n\t\tthis.progressService.withProgress({\n\t\t\tlocation: ProgressLocation.Explorer,\n\t\t\tdelay: this.layoutService.isRestored() ? 800 : 1500 // reduce progress visibility when still restoring\n\t\t}, _progress => promise);\n\n\t\treturn promise;\n\t}\n}\n\nexport interface ICompressedNavigationController {\n\treadonly current: ExplorerItem;\n\treadonly currentId: string;\n\treadonly items: ExplorerItem[];\n\treadonly labels: HTMLElement[];\n\treadonly index: number;\n\treadonly count: number;\n\treadonly onDidChange: Event<void>;\n\tprevious(): void;\n\tnext(): void;\n\tfirst(): void;\n\tlast(): void;\n\tsetIndex(index: number): void;\n\tupdateCollapsed(collapsed: boolean): void;\n}\n\nexport class CompressedNavigationController implements ICompressedNavigationController, IDisposable {\n\n\tstatic ID = 0;\n\n\tprivate _index: number;\n\tprivate _labels!: HTMLElement[];\n\tprivate _updateLabelDisposable: IDisposable;\n\n\tget index(): number { return this._index; }\n\tget count(): number { return this.items.length; }\n\tget current(): ExplorerItem { return this.items[this._index]!; }\n\tget currentId(): string { return `${this.id}_${this.index}`; }\n\tget labels(): HTMLElement[] { return this._labels; }\n\n\tprivate _onDidChange = new Emitter<void>();\n\treadonly onDidChange = this._onDidChange.event;\n\n\tconstructor(private id: string, readonly items: ExplorerItem[], templateData: IFileTemplateData, private depth: number, private collapsed: boolean) {\n\t\tthis._index = items.length - 1;\n\n\t\tthis.updateLabels(templateData);\n\t\tthis._updateLabelDisposable = templateData.label.onDidRender(() => this.updateLabels(templateData));\n\t}\n\n\tprivate updateLabels(templateData: IFileTemplateData): void {\n\t\tthis._labels = Array.from(templateData.container.querySelectorAll('.label-name')) as HTMLElement[];\n\t\tlet parents = '';\n\t\tfor (let i = 0; i < this.labels.length; i++) {\n\t\t\tconst ariaLabel = parents.length ? `${this.items[i].name}, compact, ${parents}` : this.items[i].name;\n\t\t\tthis.labels[i].setAttribute('aria-label', ariaLabel);\n\t\t\tthis.labels[i].setAttribute('aria-level', `${this.depth + i}`);\n\t\t\tparents = parents.length ? `${this.items[i].name} ${parents}` : this.items[i].name;\n\t\t}\n\t\tthis.updateCollapsed(this.collapsed);\n\n\t\tif (this._index < this.labels.length) {\n\t\t\tthis.labels[this._index].classList.add('active');\n\t\t}\n\t}\n\n\tprevious(): void {\n\t\tif (this._index <= 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setIndex(this._index - 1);\n\t}\n\n\tnext(): void {\n\t\tif (this._index >= this.items.length - 1) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setIndex(this._index + 1);\n\t}\n\n\tfirst(): void {\n\t\tif (this._index === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setIndex(0);\n\t}\n\n\tlast(): void {\n\t\tif (this._index === this.items.length - 1) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setIndex(this.items.length - 1);\n\t}\n\n\tsetIndex(index: number): void {\n\t\tif (index < 0 || index >= this.items.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.labels[this._index].classList.remove('active');\n\t\tthis._index = index;\n\t\tthis.labels[this._index].classList.add('active');\n\n\t\tthis._onDidChange.fire();\n\t}\n\n\tupdateCollapsed(collapsed: boolean): void {\n\t\tthis.collapsed = collapsed;\n\t\tfor (let i = 0; i < this.labels.length; i++) {\n\t\t\tthis.labels[i].setAttribute('aria-expanded', collapsed ? 'false' : 'true');\n\t\t}\n\t}\n\n\tdispose(): void {\n\t\tthis._onDidChange.dispose();\n\t\tthis._updateLabelDisposable.dispose();\n\t}\n}\n\nexport interface IFileTemplateData {\n\treadonly templateDisposables: DisposableStore;\n\treadonly elementDisposables: DisposableStore;\n\treadonly label: IResourceLabel;\n\treadonly container: HTMLElement;\n\n\tcurrentContext?: ExplorerItem;\n}\n\nexport class FilesRenderer implements ICompressibleTreeRenderer<ExplorerItem, FuzzyScore, IFileTemplateData>, IListAccessibilityProvider<ExplorerItem>, IDisposable {\n\tstatic readonly ID = 'file';\n\n\tprivate config: IFilesConfiguration;\n\tprivate configListener: IDisposable;\n\tprivate compressedNavigationControllers = new Map<ExplorerItem, CompressedNavigationController>();\n\n\tprivate _onDidChangeActiveDescendant = new EventMultiplexer<void>();\n\treadonly onDidChangeActiveDescendant = this._onDidChangeActiveDescendant.event;\n\n\tprivate readonly hoverDelegate = new class implements IHoverDelegate {\n\n\t\tprivate lastHoverHideTime = 0;\n\t\tprivate hiddenFromClick = false;\n\t\treadonly placement = 'element';\n\n\t\tget delay() {\n\t\t\t// Delay implementation borrowed froms src/vs/workbench/browser/parts/statusbar/statusbarPart.ts\n\t\t\tif (Date.now() - this.lastHoverHideTime < 500) {\n\t\t\t\treturn 0; // show instantly when a hover was recently shown\n\t\t\t}\n\n\t\t\treturn this.configurationService.getValue<number>('workbench.hover.delay');\n\t\t}\n\n\t\tconstructor(\n\t\t\tprivate readonly configurationService: IConfigurationService,\n\t\t\tprivate readonly hoverService: IHoverService\n\t\t) { }\n\n\t\tshowHover(options: IHoverDelegateOptions, focus?: boolean): IHoverWidget | undefined {\n\t\t\tlet element: HTMLElement;\n\t\t\tif (options.target instanceof HTMLElement) {\n\t\t\t\telement = options.target;\n\t\t\t} else {\n\t\t\t\telement = options.target.targetElements[0];\n\t\t\t}\n\n\t\t\tconst tlRow = element.closest('.monaco-tl-row') as HTMLElement | undefined;\n\t\t\tconst listRow = tlRow?.closest('.monaco-list-row') as HTMLElement | undefined;\n\n\t\t\tconst child = element.querySelector('div.monaco-icon-label-container') as Element | undefined;\n\t\t\tconst childOfChild = child?.querySelector('span.monaco-icon-name-container') as HTMLElement | undefined;\n\t\t\tlet overflowed = false;\n\t\t\tif (childOfChild && child) {\n\t\t\t\tconst width = child.clientWidth;\n\t\t\t\tconst childWidth = childOfChild.offsetWidth;\n\t\t\t\t// Check if element is overflowing its parent container\n\t\t\t\toverflowed = width <= childWidth;\n\t\t\t}\n\n\t\t\t// Only count decorations that provide additional info, as hover overing decorations such as git excluded isn't helpful\n\t\t\tconst hasDecoration = options.content.toString().includes('');\n\t\t\t// If it's overflowing or has a decoration show the tooltip\n\t\t\toverflowed = overflowed || hasDecoration;\n\n\t\t\tconst indentGuideElement = tlRow?.querySelector('.monaco-tl-indent') as HTMLElement | undefined;\n\t\t\tif (!indentGuideElement) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\treturn overflowed ? this.hoverService.showHover({\n\t\t\t\t...options,\n\t\t\t\ttarget: indentGuideElement,\n\t\t\t\tcompact: true,\n\t\t\t\tcontainer: listRow,\n\t\t\t\tadditionalClasses: ['explorer-item-hover'],\n\t\t\t\tskipFadeInAnimation: true,\n\t\t\t\tshowPointer: false,\n\t\t\t\thoverPosition: HoverPosition.RIGHT,\n\t\t\t}, focus) : undefined;\n\t\t}\n\n\t\tonDidHideHover(): void {\n\t\t\tif (!this.hiddenFromClick) {\n\t\t\t\tthis.lastHoverHideTime = Date.now();\n\t\t\t}\n\t\t\tthis.hiddenFromClick = false;\n\t\t}\n\t}(this.configurationService, this.hoverService);\n\n\tconstructor(\n\t\tcontainer: HTMLElement,\n\t\tprivate labels: ResourceLabels,\n\t\tprivate updateWidth: (stat: ExplorerItem) => void,\n\t\t@IContextViewService private readonly contextViewService: IContextViewService,\n\t\t@IThemeService private readonly themeService: IThemeService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@IExplorerService private readonly explorerService: IExplorerService,\n\t\t@ILabelService private readonly labelService: ILabelService,\n\t\t@IWorkspaceContextService private readonly contextService: IWorkspaceContextService,\n\t\t@IContextMenuService private readonly contextMenuService: IContextMenuService,\n\t\t@IHoverService private readonly hoverService: IHoverService\n\t) {\n\t\tthis.config = this.configurationService.getValue<IFilesConfiguration>();\n\n\t\tconst updateOffsetStyles = () => {\n\t\t\tconst indent = this.configurationService.getValue<number>('workbench.tree.indent');\n\t\t\tconst offset = Math.max(22 - indent, 0); // derived via inspection\n\t\t\tcontainer.style.setProperty(`--vscode-explorer-align-offset-margin-left`, `${offset}px`);\n\t\t};\n\n\t\tthis.configListener = this.configurationService.onDidChangeConfiguration(e => {\n\t\t\tif (e.affectsConfiguration('explorer')) {\n\t\t\t\tthis.config = this.configurationService.getValue();\n\t\t\t}\n\t\t\tif (e.affectsConfiguration('workbench.tree.indent')) {\n\t\t\t\tupdateOffsetStyles();\n\t\t\t}\n\t\t});\n\n\t\tupdateOffsetStyles();\n\t}\n\n\tgetWidgetAriaLabel(): string {\n\t\treturn localize('treeAriaLabel', \"Files Explorer\");\n\t}\n\n\tget templateId(): string {\n\t\treturn FilesRenderer.ID;\n\t}\n\n\trenderTemplate(container: HTMLElement): IFileTemplateData {\n\t\tconst templateDisposables = new DisposableStore();\n\t\tconst experimentalHover = this.configurationService.getValue<boolean>('explorer.experimental.hover');\n\t\tconst label = templateDisposables.add(this.labels.create(container, { supportHighlights: true, hoverDelegate: experimentalHover ? this.hoverDelegate : undefined }));\n\t\ttemplateDisposables.add(label.onDidRender(() => {\n\t\t\ttry {\n\t\t\t\tif (templateData.currentContext) {\n\t\t\t\t\tthis.updateWidth(templateData.currentContext);\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\t// noop since the element might no longer be in the tree, no update of width necessary\n\t\t\t}\n\t\t}));\n\n\t\tconst templateData: IFileTemplateData = { templateDisposables, elementDisposables: templateDisposables.add(new DisposableStore()), label, container };\n\t\treturn templateData;\n\t}\n\n\trenderElement(node: ITreeNode<ExplorerItem, FuzzyScore>, index: number, templateData: IFileTemplateData): void {\n\t\tconst stat = node.element;\n\t\ttemplateData.currentContext = stat;\n\n\t\tconst editableData = this.explorerService.getEditableData(stat);\n\n\t\ttemplateData.label.element.classList.remove('compressed');\n\n\t\t// File Label\n\t\tif (!editableData) {\n\t\t\ttemplateData.label.element.style.display = 'flex';\n\t\t\tthis.renderStat(stat, stat.name, undefined, node.filterData, templateData);\n\t\t}\n\n\t\t// Input Box\n\t\telse {\n\t\t\ttemplateData.label.element.style.display = 'none';\n\t\t\ttemplateData.elementDisposables.add(this.renderInputBox(templateData.container, stat, editableData));\n\t\t}\n\t}\n\n\trenderCompressedElements(node: ITreeNode<ICompressedTreeNode<ExplorerItem>, FuzzyScore>, index: number, templateData: IFileTemplateData, height: number | undefined): void {\n\t\tconst stat = node.element.elements[node.element.elements.length - 1];\n\t\ttemplateData.currentContext = stat;\n\n\t\tconst editable = node.element.elements.filter(e => this.explorerService.isEditable(e));\n\t\tconst editableData = editable.length === 0 ? undefined : this.explorerService.getEditableData(editable[0]);\n\n\t\t// File Label\n\t\tif (!editableData) {\n\t\t\ttemplateData.label.element.classList.add('compressed');\n\t\t\ttemplateData.label.element.style.display = 'flex';\n\n\t\t\tconst id = `compressed-explorer_${CompressedNavigationController.ID++}`;\n\n\t\t\tconst label = node.element.elements.map(e => e.name);\n\t\t\tthis.renderStat(stat, label, id, node.filterData, templateData);\n\n\t\t\tconst compressedNavigationController = new CompressedNavigationController(id, node.element.elements, templateData, node.depth, node.collapsed);\n\t\t\ttemplateData.elementDisposables.add(compressedNavigationController);\n\t\t\tthis.compressedNavigationControllers.set(stat, compressedNavigationController);\n\n\t\t\t// accessibility\n\t\t\ttemplateData.elementDisposables.add(this._onDidChangeActiveDescendant.add(compressedNavigationController.onDidChange));\n\n\t\t\ttemplateData.elementDisposables.add(DOM.addDisposableListener(templateData.container, 'mousedown', e => {\n\t\t\t\tconst result = getIconLabelNameFromHTMLElement(e.target);\n\n\t\t\t\tif (result) {\n\t\t\t\t\tcompressedNavigationController.setIndex(result.index);\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\ttemplateData.elementDisposables.add(toDisposable(() => this.compressedNavigationControllers.delete(stat)));\n\t\t}\n\n\t\t// Input Box\n\t\telse {\n\t\t\ttemplateData.label.element.classList.remove('compressed');\n\t\t\ttemplateData.label.element.style.display = 'none';\n\t\t\ttemplateData.elementDisposables.add(this.renderInputBox(templateData.container, editable[0], editableData));\n\t\t}\n\t}\n\n\tprivate renderStat(stat: ExplorerItem, label: string | string[], domId: string | undefined, filterData: FuzzyScore | undefined, templateData: IFileTemplateData): void {\n\t\ttemplateData.label.element.style.display = 'flex';\n\t\tconst extraClasses = ['explorer-item'];\n\t\tif (this.explorerService.isCut(stat)) {\n\t\t\textraClasses.push('cut');\n\t\t}\n\n\t\t// Offset nested children unless folders have both chevrons and icons, otherwise alignment breaks\n\t\tconst theme = this.themeService.getFileIconTheme();\n\n\t\t// Hack to always render chevrons for file nests, or else may not be able to identify them.\n\t\tconst twistieContainer = templateData.container.parentElement?.parentElement?.querySelector('.monaco-tl-twistie');\n\t\ttwistieContainer?.classList.toggle('force-twistie', stat.hasNests && theme.hidesExplorerArrows);\n\n\t\t// when explorer arrows are hidden or there are no folder icons, nests get misaligned as they are forced to have arrows and files typically have icons\n\t\t// Apply some CSS magic to get things looking as reasonable as possible.\n\t\tconst themeIsUnhappyWithNesting = theme.hasFileIcons && (theme.hidesExplorerArrows || !theme.hasFolderIcons);\n\t\tconst realignNestedChildren = stat.nestedParent && themeIsUnhappyWithNesting;\n\n\t\tconst experimentalHover = this.configurationService.getValue<boolean>('explorer.experimental.hover');\n\t\ttemplateData.label.setResource({ resource: stat.resource, name: label }, {\n\t\t\ttitle: experimentalHover ? isStringArray(label) ? label[0] : label : undefined,\n\t\t\tfileKind: stat.isRoot ? FileKind.ROOT_FOLDER : stat.isDirectory ? FileKind.FOLDER : FileKind.FILE,\n\t\t\textraClasses: realignNestedChildren ? [...extraClasses, 'align-nest-icon-with-parent-icon'] : extraClasses,\n\t\t\tfileDecorations: this.config.explorer.decorations,\n\t\t\tmatches: createMatches(filterData),\n\t\t\tseparator: this.labelService.getSeparator(stat.resource.scheme, stat.resource.authority),\n\t\t\tdomId\n\t\t});\n\t}\n\n\tprivate renderInputBox(container: HTMLElement, stat: ExplorerItem, editableData: IEditableData): IDisposable {\n\n\t\t// Use a file label only for the icon next to the input box\n\t\tconst label = this.labels.create(container);\n\t\tconst extraClasses = ['explorer-item', 'explorer-item-edited'];\n\t\tconst fileKind = stat.isRoot ? FileKind.ROOT_FOLDER : stat.isDirectory ? FileKind.FOLDER : FileKind.FILE;\n\n\t\tconst theme = this.themeService.getFileIconTheme();\n\t\tconst themeIsUnhappyWithNesting = theme.hasFileIcons && (theme.hidesExplorerArrows || !theme.hasFolderIcons);\n\t\tconst realignNestedChildren = stat.nestedParent && themeIsUnhappyWithNesting;\n\n\t\tconst labelOptions: IFileLabelOptions = {\n\t\t\thidePath: true,\n\t\t\thideLabel: true,\n\t\t\tfileKind,\n\t\t\textraClasses: realignNestedChildren ? [...extraClasses, 'align-nest-icon-with-parent-icon'] : extraClasses,\n\t\t};\n\n\n\t\tconst parent = stat.name ? dirname(stat.resource) : stat.resource;\n\t\tconst value = stat.name || '';\n\n\t\tlabel.setFile(joinPath(parent, value || ' '), labelOptions); // Use icon for ' ' if name is empty.\n\n\t\t// hack: hide label\n\t\t(label.element.firstElementChild as HTMLElement).style.display = 'none';\n\n\t\t// Input field for name\n\t\tconst inputBox = new InputBox(label.element, this.contextViewService, {\n\t\t\tvalidationOptions: {\n\t\t\t\tvalidation: (value) => {\n\t\t\t\t\tconst message = editableData.validationMessage(value);\n\t\t\t\t\tif (!message || message.severity !== Severity.Error) {\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn {\n\t\t\t\t\t\tcontent: message.content,\n\t\t\t\t\t\tformatContent: true,\n\t\t\t\t\t\ttype: MessageType.ERROR\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t},\n\t\t\tariaLabel: localize('fileInputAriaLabel', \"Type file name. Press Enter to confirm or Escape to cancel.\"),\n\t\t\tinputBoxStyles: defaultInputBoxStyles\n\t\t});\n\n\t\tconst lastDot = value.lastIndexOf('.');\n\t\tlet currentSelectionState = 'prefix';\n\n\t\tinputBox.value = value;\n\t\tinputBox.focus();\n\t\tinputBox.select({ start: 0, end: lastDot > 0 && !stat.isDirectory ? lastDot : value.length });\n\n\t\tconst done = once((success: boolean, finishEditing: boolean) => {\n\t\t\tlabel.element.style.display = 'none';\n\t\t\tconst value = inputBox.value;\n\t\t\tdispose(toDispose);\n\t\t\tlabel.element.remove();\n\t\t\tif (finishEditing) {\n\t\t\t\teditableData.onFinish(value, success);\n\t\t\t}\n\t\t});\n\n\t\tconst showInputBoxNotification = () => {\n\t\t\tif (inputBox.isInputValid()) {\n\t\t\t\tconst message = editableData.validationMessage(inputBox.value);\n\t\t\t\tif (message) {\n\t\t\t\t\tinputBox.showMessage({\n\t\t\t\t\t\tcontent: message.content,\n\t\t\t\t\t\tformatContent: true,\n\t\t\t\t\t\ttype: message.severity === Severity.Info ? MessageType.INFO : message.severity === Severity.Warning ? MessageType.WARNING : MessageType.ERROR\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tinputBox.hideMessage();\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tshowInputBoxNotification();\n\n\t\tconst toDispose = [\n\t\t\tinputBox,\n\t\t\tinputBox.onDidChange(value => {\n\t\t\t\tlabel.setFile(joinPath(parent, value || ' '), labelOptions); // update label icon while typing!\n\t\t\t}),\n\t\t\tDOM.addStandardDisposableListener(inputBox.inputElement, DOM.EventType.KEY_DOWN, (e: IKeyboardEvent) => {\n\t\t\t\tif (e.equals(KeyCode.F2)) {\n\t\t\t\t\tconst dotIndex = inputBox.value.lastIndexOf('.');\n\t\t\t\t\tif (stat.isDirectory || dotIndex === -1) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (currentSelectionState === 'prefix') {\n\t\t\t\t\t\tcurrentSelectionState = 'all';\n\t\t\t\t\t\tinputBox.select({ start: 0, end: inputBox.value.length });\n\t\t\t\t\t} else if (currentSelectionState === 'all') {\n\t\t\t\t\t\tcurrentSelectionState = 'suffix';\n\t\t\t\t\t\tinputBox.select({ start: dotIndex + 1, end: inputBox.value.length });\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcurrentSelectionState = 'prefix';\n\t\t\t\t\t\tinputBox.select({ start: 0, end: dotIndex });\n\t\t\t\t\t}\n\t\t\t\t} else if (e.equals(KeyCode.Enter)) {\n\t\t\t\t\tif (!inputBox.validate()) {\n\t\t\t\t\t\tdone(true, true);\n\t\t\t\t\t}\n\t\t\t\t} else if (e.equals(KeyCode.Escape)) {\n\t\t\t\t\tdone(false, true);\n\t\t\t\t}\n\t\t\t}),\n\t\t\tDOM.addStandardDisposableListener(inputBox.inputElement, DOM.EventType.KEY_UP, (e: IKeyboardEvent) => {\n\t\t\t\tshowInputBoxNotification();\n\t\t\t}),\n\t\t\tDOM.addDisposableListener(inputBox.inputElement, DOM.EventType.BLUR, async () => {\n\t\t\t\twhile (true) {\n\t\t\t\t\tawait timeout(0);\n\n\t\t\t\t\tif (!document.hasFocus()) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t} if (document.activeElement === inputBox.inputElement) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t} else if (document.activeElement instanceof HTMLElement && DOM.hasParentWithClass(document.activeElement, 'context-view')) {\n\t\t\t\t\t\tawait Event.toPromise(this.contextMenuService.onDidHideContextMenu);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tdone(inputBox.isInputValid(), true);\n\t\t\t}),\n\t\t\tlabel\n\t\t];\n\n\t\treturn toDisposable(() => {\n\t\t\tdone(false, false);\n\t\t});\n\t}\n\n\tdisposeElement(element: ITreeNode<ExplorerItem, FuzzyScore>, index: number, templateData: IFileTemplateData): void {\n\t\ttemplateData.currentContext = undefined;\n\t\ttemplateData.elementDisposables.clear();\n\t}\n\n\tdisposeCompressedElements(node: ITreeNode<ICompressedTreeNode<ExplorerItem>, FuzzyScore>, index: number, templateData: IFileTemplateData): void {\n\t\ttemplateData.currentContext = undefined;\n\t\ttemplateData.elementDisposables.clear();\n\t}\n\n\tdisposeTemplate(templateData: IFileTemplateData): void {\n\t\ttemplateData.templateDisposables.dispose();\n\t}\n\n\tgetCompressedNavigationController(stat: ExplorerItem): ICompressedNavigationController | undefined {\n\t\treturn this.compressedNavigationControllers.get(stat);\n\t}\n\n\t// IAccessibilityProvider\n\n\tgetAriaLabel(element: ExplorerItem): string {\n\t\treturn element.name;\n\t}\n\n\tgetAriaLevel(element: ExplorerItem): number {\n\t\t// We need to comput aria level on our own since children of compact folders will otherwise have an incorrect level\t#107235\n\t\tlet depth = 0;\n\t\tlet parent = element.parent;\n\t\twhile (parent) {\n\t\t\tparent = parent.parent;\n\t\t\tdepth++;\n\t\t}\n\n\t\tif (this.contextService.getWorkbenchState() === WorkbenchState.WORKSPACE) {\n\t\t\tdepth = depth + 1;\n\t\t}\n\n\t\treturn depth;\n\t}\n\n\tgetActiveDescendantId(stat: ExplorerItem): string | undefined {\n\t\tconst compressedNavigationController = this.compressedNavigationControllers.get(stat);\n\t\treturn compressedNavigationController?.currentId;\n\t}\n\n\tdispose(): void {\n\t\tthis.configListener.dispose();\n\t}\n}\n\ninterface CachedParsedExpression {\n\toriginal: glob.IExpression;\n\tparsed: glob.ParsedExpression;\n}\n\n/**\n * Respects files.exclude setting in filtering out content from the explorer.\n * Makes sure that visible editors are always shown in the explorer even if they are filtered out by settings.\n */\nexport class FilesFilter implements ITreeFilter<ExplorerItem, FuzzyScore> {\n\tprivate hiddenExpressionPerRoot = new Map<string, CachedParsedExpression>();\n\tprivate editorsAffectingFilter = new Set<EditorInput>();\n\tprivate _onDidChange = new Emitter<void>();\n\tprivate toDispose: IDisposable[] = [];\n\t// List of ignoreFile resources. Used to detect changes to the ignoreFiles.\n\tprivate ignoreFileResourcesPerRoot = new Map<string, ResourceSet>();\n\t// Ignore tree per root. Similar to `hiddenExpressionPerRoot`\n\t// Note: URI in the ternary search tree is the URI of the folder containing the ignore file\n\t// It is not the ignore file itself. This is because of the way the IgnoreFile works and nested paths\n\tprivate ignoreTreesPerRoot = new Map<string, TernarySearchTree<URI, IgnoreFile>>();\n\n\tconstructor(\n\t\t@IWorkspaceContextService private readonly contextService: IWorkspaceContextService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@IExplorerService private readonly explorerService: IExplorerService,\n\t\t@IEditorService private readonly editorService: IEditorService,\n\t\t@IUriIdentityService private readonly uriIdentityService: IUriIdentityService,\n\t\t@IFileService private readonly fileService: IFileService\n\t) {\n\t\tthis.toDispose.push(this.contextService.onDidChangeWorkspaceFolders(() => this.updateConfiguration()));\n\t\tthis.toDispose.push(this.configurationService.onDidChangeConfiguration((e) => {\n\t\t\tif (e.affectsConfiguration('files.exclude') || e.affectsConfiguration('explorer.excludeGitIgnore')) {\n\t\t\t\tthis.updateConfiguration();\n\t\t\t}\n\t\t}));\n\t\tthis.toDispose.push(this.fileService.onDidFilesChange(e => {\n\t\t\t// Check to see if the update contains any of the ignoreFileResources\n\t\t\tfor (const [root, ignoreFileResourceSet] of this.ignoreFileResourcesPerRoot.entries()) {\n\t\t\t\tignoreFileResourceSet.forEach(async ignoreResource => {\n\t\t\t\t\tif (e.contains(ignoreResource, FileChangeType.UPDATED)) {\n\t\t\t\t\t\tawait this.processIgnoreFile(root, ignoreResource, true);\n\t\t\t\t\t}\n\t\t\t\t\tif (e.contains(ignoreResource, FileChangeType.DELETED)) {\n\t\t\t\t\t\tthis.ignoreTreesPerRoot.get(root)?.delete(dirname(ignoreResource));\n\t\t\t\t\t\tignoreFileResourceSet.delete(ignoreResource);\n\t\t\t\t\t\tthis._onDidChange.fire();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}));\n\t\tthis.toDispose.push(this.editorService.onDidVisibleEditorsChange(() => {\n\t\t\tconst editors = this.editorService.visibleEditors;\n\t\t\tlet shouldFire = false;\n\n\t\t\tfor (const e of editors) {\n\t\t\t\tif (!e.resource) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tconst stat = this.explorerService.findClosest(e.resource);\n\t\t\t\tif (stat && stat.isExcluded) {\n\t\t\t\t\t// A filtered resource suddenly became visible since user opened an editor\n\t\t\t\t\tshouldFire = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (const e of this.editorsAffectingFilter) {\n\t\t\t\tif (!editors.includes(e)) {\n\t\t\t\t\t// Editor that was affecting filtering is no longer visible\n\t\t\t\t\tshouldFire = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (shouldFire) {\n\t\t\t\tthis.editorsAffectingFilter.clear();\n\t\t\t\tthis._onDidChange.fire();\n\t\t\t}\n\t\t}));\n\t\tthis.updateConfiguration();\n\t}\n\n\tget onDidChange(): Event<void> {\n\t\treturn this._onDidChange.event;\n\t}\n\n\tprivate updateConfiguration(): void {\n\t\tlet shouldFire = false;\n\t\tlet updatedGitIgnoreSetting = false;\n\t\tthis.contextService.getWorkspace().folders.forEach(folder => {\n\t\t\tconst configuration = this.configurationService.getValue<IFilesConfiguration>({ resource: folder.uri });\n\t\t\tconst excludesConfig: glob.IExpression = configuration?.files?.exclude || Object.create(null);\n\t\t\tconst parseIgnoreFile: boolean = configuration.explorer.excludeGitIgnore;\n\n\t\t\t// If we should be parsing ignoreFiles for this workspace and don't have an ignore tree initialize one\n\t\t\tif (parseIgnoreFile && !this.ignoreTreesPerRoot.has(folder.uri.toString())) {\n\t\t\t\tupdatedGitIgnoreSetting = true;\n\t\t\t\tthis.ignoreFileResourcesPerRoot.set(folder.uri.toString(), new ResourceSet());\n\t\t\t\tthis.ignoreTreesPerRoot.set(folder.uri.toString(), TernarySearchTree.forUris((uri) => this.uriIdentityService.extUri.ignorePathCasing(uri)));\n\t\t\t}\n\n\t\t\t// If we shouldn't be parsing ignore files but have an ignore tree, clear the ignore tree\n\t\t\tif (!parseIgnoreFile && this.ignoreTreesPerRoot.has(folder.uri.toString())) {\n\t\t\t\tupdatedGitIgnoreSetting = true;\n\t\t\t\tthis.ignoreFileResourcesPerRoot.delete(folder.uri.toString());\n\t\t\t\tthis.ignoreTreesPerRoot.delete(folder.uri.toString());\n\t\t\t}\n\n\t\t\tif (!shouldFire) {\n\t\t\t\tconst cached = this.hiddenExpressionPerRoot.get(folder.uri.toString());\n\t\t\t\tshouldFire = !cached || !equals(cached.original, excludesConfig);\n\t\t\t}\n\n\t\t\tconst excludesConfigCopy = deepClone(excludesConfig); // do not keep the config, as it gets mutated under our hoods\n\n\t\t\tthis.hiddenExpressionPerRoot.set(folder.uri.toString(), { original: excludesConfigCopy, parsed: glob.parse(excludesConfigCopy) });\n\t\t});\n\n\t\tif (shouldFire || updatedGitIgnoreSetting) {\n\t\t\tthis.editorsAffectingFilter.clear();\n\t\t\tthis._onDidChange.fire();\n\t\t}\n\t}\n\n\t/**\n\t * Given a .gitignore file resource, processes the resource and adds it to the ignore tree which hides explorer items\n\t * @param root The root folder of the workspace as a string. Used for lookup key for ignore tree and resource list\n\t * @param ignoreFileResource The resource of the .gitignore file\n\t * @param update Whether or not we're updating an existing ignore file. If true it deletes the old entry\n\t */\n\tprivate async processIgnoreFile(root: string, ignoreFileResource: URI, update?: boolean) {\n\t\t// Get the name of the directory which the ignore file is in\n\t\tconst dirUri = dirname(ignoreFileResource);\n\t\tconst ignoreTree = this.ignoreTreesPerRoot.get(root);\n\t\tif (!ignoreTree) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Don't process a directory if we already have it in the tree\n\t\tif (!update && ignoreTree.has(dirUri)) {\n\t\t\treturn;\n\t\t}\n\t\t// Maybe we need a cancellation token here in case it's super long?\n\t\tconst content = await this.fileService.readFile(ignoreFileResource);\n\n\t\t// If it's just an update we update the contents keeping all references the same\n\t\tif (update) {\n\t\t\tconst ignoreFile = ignoreTree.get(dirUri);\n\t\t\tignoreFile?.updateContents(content.value.toString());\n\t\t} else {\n\t\t\t// Otherwise we create a new ignorefile and add it to the tree\n\t\t\tconst ignoreParent = ignoreTree.findSubstr(dirUri);\n\t\t\tconst ignoreFile = new IgnoreFile(content.value.toString(), dirUri.path, ignoreParent);\n\t\t\tignoreTree.set(dirUri, ignoreFile);\n\t\t\t// If we haven't seen this resource before then we need to add it to the list of resources we're tracking\n\t\t\tif (!this.ignoreFileResourcesPerRoot.get(root)?.has(ignoreFileResource)) {\n\t\t\t\tthis.ignoreFileResourcesPerRoot.get(root)?.add(ignoreFileResource);\n\t\t\t}\n\t\t}\n\n\t\t// Notify the explorer of the change so we may ignore these files\n\t\tthis._onDidChange.fire();\n\t}\n\n\tfilter(stat: ExplorerItem, parentVisibility: TreeVisibility): boolean {\n\t\t// Add newly visited .gitignore files to the ignore tree\n\t\tif (stat.name === '.gitignore' && this.ignoreTreesPerRoot.has(stat.root.resource.toString())) {\n\t\t\tthis.processIgnoreFile(stat.root.resource.toString(), stat.resource, false);\n\t\t\treturn true;\n\t\t}\n\n\t\treturn this.isVisible(stat, parentVisibility);\n\t}\n\n\tprivate isVisible(stat: ExplorerItem, parentVisibility: TreeVisibility): boolean {\n\t\tstat.isExcluded = false;\n\t\tif (parentVisibility === TreeVisibility.Hidden) {\n\t\t\tstat.isExcluded = true;\n\t\t\treturn false;\n\t\t}\n\t\tif (this.explorerService.getEditableData(stat)) {\n\t\t\treturn true; // always visible\n\t\t}\n\n\t\t// Hide those that match Hidden Patterns\n\t\tconst cached = this.hiddenExpressionPerRoot.get(stat.root.resource.toString());\n\t\tconst globMatch = cached?.parsed(path.relative(stat.root.resource.path, stat.resource.path), stat.name, name => !!(stat.parent && stat.parent.getChild(name)));\n\t\t// Small optimization to only traverse gitIgnore if the globMatch from fileExclude returned nothing\n\t\tconst ignoreFile = globMatch ? undefined : this.ignoreTreesPerRoot.get(stat.root.resource.toString())?.findSubstr(stat.resource);\n\t\tconst isIncludedInTraversal = ignoreFile?.isPathIncludedInTraversal(stat.resource.path, stat.isDirectory);\n\t\t// Doing !undefined returns true and we want it to be false when undefined because that means it's not included in the ignore file\n\t\tconst isIgnoredByIgnoreFile = isIncludedInTraversal === undefined ? false : !isIncludedInTraversal;\n\t\tif (isIgnoredByIgnoreFile || globMatch || stat.parent?.isExcluded) {\n\t\t\tstat.isExcluded = true;\n\t\t\tconst editors = this.editorService.visibleEditors;\n\t\t\tconst editor = editors.find(e => e.resource && this.uriIdentityService.extUri.isEqualOrParent(e.resource, stat.resource));\n\t\t\tif (editor && stat.root === this.explorerService.findClosestRoot(stat.resource)) {\n\t\t\t\tthis.editorsAffectingFilter.add(editor);\n\t\t\t\treturn true; // Show all opened files and their parents\n\t\t\t}\n\n\t\t\treturn false; // hidden through pattern\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tdispose(): void {\n\t\tdispose(this.toDispose);\n\t}\n}\n\n// Explorer Sorter\nexport class FileSorter implements ITreeSorter<ExplorerItem> {\n\n\tconstructor(\n\t\t@IExplorerService private readonly explorerService: IExplorerService,\n\t\t@IWorkspaceContextService private readonly contextService: IWorkspaceContextService\n\t) { }\n\n\tcompare(statA: ExplorerItem, statB: ExplorerItem): number {\n\t\t// Do not sort roots\n\t\tif (statA.isRoot) {\n\t\t\tif (statB.isRoot) {\n\t\t\t\tconst workspaceA = this.contextService.getWorkspaceFolder(statA.resource);\n\t\t\t\tconst workspaceB = this.contextService.getWorkspaceFolder(statB.resource);\n\t\t\t\treturn workspaceA && workspaceB ? (workspaceA.index - workspaceB.index) : -1;\n\t\t\t}\n\n\t\t\treturn -1;\n\t\t}\n\n\t\tif (statB.isRoot) {\n\t\t\treturn 1;\n\t\t}\n\n\t\tconst sortOrder = this.explorerService.sortOrderConfiguration.sortOrder;\n\t\tconst lexicographicOptions = this.explorerService.sortOrderConfiguration.lexicographicOptions;\n\n\t\tlet compareFileNames;\n\t\tlet compareFileExtensions;\n\t\tswitch (lexicographicOptions) {\n\t\t\tcase 'upper':\n\t\t\t\tcompareFileNames = compareFileNamesUpper;\n\t\t\t\tcompareFileExtensions = compareFileExtensionsUpper;\n\t\t\t\tbreak;\n\t\t\tcase 'lower':\n\t\t\t\tcompareFileNames = compareFileNamesLower;\n\t\t\t\tcompareFileExtensions = compareFileExtensionsLower;\n\t\t\t\tbreak;\n\t\t\tcase 'unicode':\n\t\t\t\tcompareFileNames = compareFileNamesUnicode;\n\t\t\t\tcompareFileExtensions = compareFileExtensionsUnicode;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\t// 'default'\n\t\t\t\tcompareFileNames = compareFileNamesDefault;\n\t\t\t\tcompareFileExtensions = compareFileExtensionsDefault;\n\t\t}\n\n\t\t// Sort Directories\n\t\tswitch (sortOrder) {\n\t\t\tcase 'type':\n\t\t\t\tif (statA.isDirectory && !statB.isDirectory) {\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\n\t\t\t\tif (statB.isDirectory && !statA.isDirectory) {\n\t\t\t\t\treturn 1;\n\t\t\t\t}\n\n\t\t\t\tif (statA.isDirectory && statB.isDirectory) {\n\t\t\t\t\treturn compareFileNames(statA.name, statB.name);\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'filesFirst':\n\t\t\t\tif (statA.isDirectory && !statB.isDirectory) {\n\t\t\t\t\treturn 1;\n\t\t\t\t}\n\n\t\t\t\tif (statB.isDirectory && !statA.isDirectory) {\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'foldersNestsFiles':\n\t\t\t\tif (statA.isDirectory && !statB.isDirectory) {\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\n\t\t\t\tif (statB.isDirectory && !statA.isDirectory) {\n\t\t\t\t\treturn 1;\n\t\t\t\t}\n\n\t\t\t\tif (statA.hasNests && !statB.hasNests) {\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\n\t\t\t\tif (statB.hasNests && !statA.hasNests) {\n\t\t\t\t\treturn 1;\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'mixed':\n\t\t\t\tbreak; // not sorting when \"mixed\" is on\n\n\t\t\tdefault: /* 'default', 'modified' */\n\t\t\t\tif (statA.isDirectory && !statB.isDirectory) {\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\n\t\t\t\tif (statB.isDirectory && !statA.isDirectory) {\n\t\t\t\t\treturn 1;\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t}\n\n\t\t// Sort Files\n\t\tswitch (sortOrder) {\n\t\t\tcase 'type':\n\t\t\t\treturn compareFileExtensions(statA.name, statB.name);\n\n\t\t\tcase 'modified':\n\t\t\t\tif (statA.mtime !== statB.mtime) {\n\t\t\t\t\treturn (statA.mtime && statB.mtime && statA.mtime < statB.mtime) ? 1 : -1;\n\t\t\t\t}\n\n\t\t\t\treturn compareFileNames(statA.name, statB.name);\n\n\t\t\tdefault: /* 'default', 'mixed', 'filesFirst' */\n\t\t\t\treturn compareFileNames(statA.name, statB.name);\n\t\t}\n\t}\n}\n\nexport class FileDragAndDrop implements ITreeDragAndDrop<ExplorerItem> {\n\tprivate static readonly CONFIRM_DND_SETTING_KEY = 'explorer.confirmDragAndDrop';\n\n\tprivate compressedDragOverElement: HTMLElement | undefined;\n\tprivate compressedDropTargetDisposable: IDisposable = Disposable.None;\n\n\tprivate toDispose: IDisposable[];\n\tprivate dropEnabled = false;\n\n\tconstructor(\n\t\tprivate isCollapsed: (item: ExplorerItem) => boolean,\n\t\t@IExplorerService private explorerService: IExplorerService,\n\t\t@IEditorService private editorService: IEditorService,\n\t\t@IDialogService private dialogService: IDialogService,\n\t\t@IWorkspaceContextService private contextService: IWorkspaceContextService,\n\t\t@IFileService private fileService: IFileService,\n\t\t@IConfigurationService private configurationService: IConfigurationService,\n\t\t@IInstantiationService private instantiationService: IInstantiationService,\n\t\t@IWorkspaceEditingService private workspaceEditingService: IWorkspaceEditingService,\n\t\t@IUriIdentityService private readonly uriIdentityService: IUriIdentityService\n\t) {\n\t\tthis.toDispose = [];\n\n\t\tconst updateDropEnablement = (e: IConfigurationChangeEvent | undefined) => {\n\t\t\tif (!e || e.affectsConfiguration('explorer.enableDragAndDrop')) {\n\t\t\t\tthis.dropEnabled = this.configurationService.getValue('explorer.enableDragAndDrop');\n\t\t\t}\n\t\t};\n\t\tupdateDropEnablement(undefined);\n\t\tthis.toDispose.push(this.configurationService.onDidChangeConfiguration(e => updateDropEnablement(e)));\n\t}\n\n\tonDragOver(data: IDragAndDropData, target: ExplorerItem | undefined, targetIndex: number | undefined, originalEvent: DragEvent): boolean | ITreeDragOverReaction {\n\t\tif (!this.dropEnabled) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Compressed folders\n\t\tif (target) {\n\t\t\tconst compressedTarget = FileDragAndDrop.getCompressedStatFromDragEvent(target, originalEvent);\n\n\t\t\tif (compressedTarget) {\n\t\t\t\tconst iconLabelName = getIconLabelNameFromHTMLElement(originalEvent.target);\n\n\t\t\t\tif (iconLabelName && iconLabelName.index < iconLabelName.count - 1) {\n\t\t\t\t\tconst result = this.handleDragOver(data, compressedTarget, targetIndex, originalEvent);\n\n\t\t\t\t\tif (result) {\n\t\t\t\t\t\tif (iconLabelName.element !== this.compressedDragOverElement) {\n\t\t\t\t\t\t\tthis.compressedDragOverElement = iconLabelName.element;\n\t\t\t\t\t\t\tthis.compressedDropTargetDisposable.dispose();\n\t\t\t\t\t\t\tthis.compressedDropTargetDisposable = toDisposable(() => {\n\t\t\t\t\t\t\t\ticonLabelName.element.classList.remove('drop-target');\n\t\t\t\t\t\t\t\tthis.compressedDragOverElement = undefined;\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\ticonLabelName.element.classList.add('drop-target');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn typeof result === 'boolean' ? result : { ...result, feedback: [] };\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.compressedDropTargetDisposable.dispose();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.compressedDropTargetDisposable.dispose();\n\t\treturn this.handleDragOver(data, target, targetIndex, originalEvent);\n\t}\n\n\tprivate handleDragOver(data: IDragAndDropData, target: ExplorerItem | undefined, targetIndex: number | undefined, originalEvent: DragEvent): boolean | ITreeDragOverReaction {\n\t\tconst isCopy = originalEvent && ((originalEvent.ctrlKey && !isMacintosh) || (originalEvent.altKey && isMacintosh));\n\t\tconst isNative = data instanceof NativeDragAndDropData;\n\t\tconst effect = (isNative || isCopy) ? ListDragOverEffect.Copy : ListDragOverEffect.Move;\n\n\t\t// Native DND\n\t\tif (isNative) {\n\t\t\tif (!containsDragType(originalEvent, DataTransfers.FILES, CodeDataTransfers.FILES, DataTransfers.RESOURCES)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\t// Other-Tree DND\n\t\telse if (data instanceof ExternalElementsDragAndDropData) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// In-Explorer DND\n\t\telse {\n\t\t\tconst items = FileDragAndDrop.getStatsFromDragAndDropData(data as ElementsDragAndDropData<ExplorerItem, ExplorerItem[]>);\n\n\t\t\tif (!target) {\n\t\t\t\t// Dropping onto the empty area. Do not accept if items dragged are already\n\t\t\t\t// children of the root unless we are copying the file\n\t\t\t\tif (!isCopy && items.every(i => !!i.parent && i.parent.isRoot)) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn { accept: true, bubble: TreeDragOverBubble.Down, effect, autoExpand: false };\n\t\t\t}\n\n\t\t\tif (!Array.isArray(items)) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (!isCopy && items.every((source) => source.isReadonly)) {\n\t\t\t\treturn false; // Cannot move readonly items unless we copy\n\t\t\t}\n\n\t\t\tif (items.some((source) => {\n\t\t\t\tif (source.isRoot && target instanceof ExplorerItem && !target.isRoot) {\n\t\t\t\t\treturn true; // Root folder can not be moved to a non root file stat.\n\t\t\t\t}\n\n\t\t\t\tif (this.uriIdentityService.extUri.isEqual(source.resource, target.resource)) {\n\t\t\t\t\treturn true; // Can not move anything onto itself\n\t\t\t\t}\n\n\t\t\t\tif (source.isRoot && target instanceof ExplorerItem && target.isRoot) {\n\t\t\t\t\t// Disable moving workspace roots in one another\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif (!isCopy && this.uriIdentityService.extUri.isEqual(dirname(source.resource), target.resource)) {\n\t\t\t\t\treturn true; // Can not move a file to the same parent unless we copy\n\t\t\t\t}\n\n\t\t\t\tif (this.uriIdentityService.extUri.isEqualOrParent(target.resource, source.resource)) {\n\t\t\t\t\treturn true; // Can not move a parent folder into one of its children\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t})) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\t// All (target = model)\n\t\tif (!target) {\n\t\t\treturn { accept: true, bubble: TreeDragOverBubble.Down, effect };\n\t\t}\n\n\t\t// All (target = file/folder)\n\t\telse {\n\t\t\tif (target.isDirectory) {\n\t\t\t\tif (target.isReadonly) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn { accept: true, bubble: TreeDragOverBubble.Down, effect, autoExpand: true };\n\t\t\t}\n\n\t\t\tif (this.contextService.getWorkspace().folders.every(folder => folder.uri.toString() !== target.resource.toString())) {\n\t\t\t\treturn { accept: true, bubble: TreeDragOverBubble.Up, effect };\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tgetDragURI(element: ExplorerItem): string | null {\n\t\tif (this.explorerService.isEditable(element)) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn element.resource.toString();\n\t}\n\n\tgetDragLabel(elements: ExplorerItem[], originalEvent: DragEvent): string | undefined {\n\t\tif (elements.length === 1) {\n\t\t\tconst stat = FileDragAndDrop.getCompressedStatFromDragEvent(elements[0], originalEvent);\n\t\t\treturn stat.name;\n\t\t}\n\n\t\treturn String(elements.length);\n\t}\n\n\tonDragStart(data: IDragAndDropData, originalEvent: DragEvent): void {\n\t\tconst items = FileDragAndDrop.getStatsFromDragAndDropData(data as ElementsDragAndDropData<ExplorerItem, ExplorerItem[]>, originalEvent);\n\t\tif (items && items.length && originalEvent.dataTransfer) {\n\t\t\t// Apply some datatransfer types to allow for dragging the element outside of the application\n\t\t\tthis.instantiationService.invokeFunction(accessor => fillEditorsDragData(accessor, items, originalEvent));\n\n\t\t\t// The only custom data transfer we set from the explorer is a file transfer\n\t\t\t// to be able to DND between multiple code file explorers across windows\n\t\t\tconst fileResources = items.filter(s => s.resource.scheme === Schemas.file).map(r => r.resource.fsPath);\n\t\t\tif (fileResources.length) {\n\t\t\t\toriginalEvent.dataTransfer.setData(CodeDataTransfers.FILES, JSON.stringify(fileResources));\n\t\t\t}\n\t\t}\n\t}\n\n\tasync drop(data: IDragAndDropData, target: ExplorerItem | undefined, targetIndex: number | undefined, originalEvent: DragEvent): Promise<void> {\n\t\tthis.compressedDropTargetDisposable.dispose();\n\n\t\t// Find compressed target\n\t\tif (target) {\n\t\t\tconst compressedTarget = FileDragAndDrop.getCompressedStatFromDragEvent(target, originalEvent);\n\n\t\t\tif (compressedTarget) {\n\t\t\t\ttarget = compressedTarget;\n\t\t\t}\n\t\t}\n\n\t\t// Find parent to add to\n\t\tif (!target) {\n\t\t\ttarget = this.explorerService.roots[this.explorerService.roots.length - 1];\n\t\t}\n\t\tif (!target.isDirectory && target.parent) {\n\t\t\ttarget = target.parent;\n\t\t}\n\t\tif (target.isReadonly) {\n\t\t\treturn;\n\t\t}\n\t\tconst resolvedTarget = target;\n\t\tif (!resolvedTarget) {\n\t\t\treturn;\n\t\t}\n\n\t\ttry {\n\n\t\t\t// External file DND (Import/Upload file)\n\t\t\tif (data instanceof NativeDragAndDropData) {\n\t\t\t\t// Use local file import when supported\n\t\t\t\tif (!isWeb || (isTemporaryWorkspace(this.contextService.getWorkspace()) && WebFileSystemAccess.supported(window))) {\n\t\t\t\t\tconst fileImport = this.instantiationService.createInstance(ExternalFileImport);\n\t\t\t\t\tawait fileImport.import(resolvedTarget, originalEvent);\n\t\t\t\t}\n\t\t\t\t// Otherwise fallback to browser based file upload\n\t\t\t\telse {\n\t\t\t\t\tconst browserUpload = this.instantiationService.createInstance(BrowserFileUpload);\n\t\t\t\t\tawait browserUpload.upload(target, originalEvent);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// In-Explorer DND (Move/Copy file)\n\t\t\telse {\n\t\t\t\tawait this.handleExplorerDrop(data as ElementsDragAndDropData<ExplorerItem, ExplorerItem[]>, resolvedTarget, originalEvent);\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tthis.dialogService.error(toErrorMessage(error));\n\t\t}\n\t}\n\n\tprivate async handleExplorerDrop(data: ElementsDragAndDropData<ExplorerItem, ExplorerItem[]>, target: ExplorerItem, originalEvent: DragEvent): Promise<void> {\n\t\tconst elementsData = FileDragAndDrop.getStatsFromDragAndDropData(data);\n\t\tconst distinctItems = new Map(elementsData.map(element => [element, this.isCollapsed(element)]));\n\n\t\tfor (const [item, collapsed] of distinctItems) {\n\t\t\tif (collapsed) {\n\t\t\t\tconst nestedChildren = item.nestedChildren;\n\t\t\t\tif (nestedChildren) {\n\t\t\t\t\tfor (const child of nestedChildren) {\n\t\t\t\t\t\t// if parent is collapsed, then the nested children is considered collapsed to operate as a group\n\t\t\t\t\t\t// and skip collapsed state check since they're not in the tree\n\t\t\t\t\t\tdistinctItems.set(child, true);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst items = distinctParents([...distinctItems.keys()], s => s.resource);\n\t\tconst isCopy = (originalEvent.ctrlKey && !isMacintosh) || (originalEvent.altKey && isMacintosh);\n\n\t\t// Handle confirm setting\n\t\tconst confirmDragAndDrop = !isCopy && this.configurationService.getValue<boolean>(FileDragAndDrop.CONFIRM_DND_SETTING_KEY);\n\t\tif (confirmDragAndDrop) {\n\t\t\tconst message = items.length > 1 && items.every(s => s.isRoot) ? localize('confirmRootsMove', \"Are you sure you want to change the order of multiple root folders in your workspace?\")\n\t\t\t\t: items.length > 1 ? localize('confirmMultiMove', \"Are you sure you want to move the following {0} files into '{1}'?\", items.length, target.name)\n\t\t\t\t\t: items[0].isRoot ? localize('confirmRootMove', \"Are you sure you want to change the order of root folder '{0}' in your workspace?\", items[0].name)\n\t\t\t\t\t\t: localize('confirmMove', \"Are you sure you want to move '{0}' into '{1}'?\", items[0].name, target.name);\n\t\t\tconst detail = items.length > 1 && !items.every(s => s.isRoot) ? getFileNamesMessage(items.map(i => i.resource)) : undefined;\n\n\t\t\tconst confirmation = await this.dialogService.confirm({\n\t\t\t\tmessage,\n\t\t\t\tdetail,\n\t\t\t\tcheckbox: {\n\t\t\t\t\tlabel: localize('doNotAskAgain', \"Do not ask me again\")\n\t\t\t\t},\n\t\t\t\tprimaryButton: localize({ key: 'moveButtonLabel', comment: ['&& denotes a mnemonic'] }, \"&&Move\")\n\t\t\t});\n\n\t\t\tif (!confirmation.confirmed) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Check for confirmation checkbox\n\t\t\tif (confirmation.checkboxChecked === true) {\n\t\t\t\tawait this.configurationService.updateValue(FileDragAndDrop.CONFIRM_DND_SETTING_KEY, false);\n\t\t\t}\n\t\t}\n\n\t\tawait this.doHandleRootDrop(items.filter(s => s.isRoot), target);\n\n\t\tconst sources = items.filter(s => !s.isRoot);\n\t\tif (isCopy) {\n\t\t\treturn this.doHandleExplorerDropOnCopy(sources, target);\n\t\t}\n\n\t\treturn this.doHandleExplorerDropOnMove(sources, target);\n\t}\n\n\tprivate async doHandleRootDrop(roots: ExplorerItem[], target: ExplorerItem): Promise<void> {\n\t\tif (roots.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst folders = this.contextService.getWorkspace().folders;\n\t\tlet targetIndex: number | undefined;\n\t\tconst workspaceCreationData: IWorkspaceFolderCreationData[] = [];\n\t\tconst rootsToMove: IWorkspaceFolderCreationData[] = [];\n\n\t\tfor (let index = 0; index < folders.length; index++) {\n\t\t\tconst data = {\n\t\t\t\turi: folders[index].uri,\n\t\t\t\tname: folders[index].name\n\t\t\t};\n\t\t\tif (target instanceof ExplorerItem && this.uriIdentityService.extUri.isEqual(folders[index].uri, target.resource)) {\n\t\t\t\ttargetIndex = index;\n\t\t\t}\n\n\t\t\tif (roots.every(r => r.resource.toString() !== folders[index].uri.toString())) {\n\t\t\t\tworkspaceCreationData.push(data);\n\t\t\t} else {\n\t\t\t\trootsToMove.push(data);\n\t\t\t}\n\t\t}\n\t\tif (targetIndex === undefined) {\n\t\t\ttargetIndex = workspaceCreationData.length;\n\t\t}\n\n\t\tworkspaceCreationData.splice(targetIndex, 0, ...rootsToMove);\n\n\t\treturn this.workspaceEditingService.updateFolders(0, workspaceCreationData.length, workspaceCreationData);\n\t}\n\n\tprivate async doHandleExplorerDropOnCopy(sources: ExplorerItem[], target: ExplorerItem): Promise<void> {\n\n\t\t// Reuse duplicate action when user copies\n\t\tconst explorerConfig = this.configurationService.getValue<IFilesConfiguration>().explorer;\n\t\tconst resourceFileEdits: ResourceFileEdit[] = [];\n\t\tfor (const { resource, isDirectory } of sources) {\n\t\t\tconst allowOverwrite = explorerConfig.incrementalNaming === 'disabled';\n\t\t\tconst newResource = await findValidPasteFileTarget(this.explorerService,\n\t\t\t\tthis.fileService,\n\t\t\t\tthis.dialogService,\n\t\t\t\ttarget,\n\t\t\t\t{ resource, isDirectory, allowOverwrite },\n\t\t\t\texplorerConfig.incrementalNaming\n\t\t\t);\n\t\t\tif (!newResource) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tconst resourceEdit = new ResourceFileEdit(resource, newResource, { copy: true, overwrite: allowOverwrite });\n\t\t\tresourceFileEdits.push(resourceEdit);\n\t\t}\n\t\tconst labelSuffix = getFileOrFolderLabelSuffix(sources);\n\t\tawait this.explorerService.applyBulkEdit(resourceFileEdits, {\n\t\t\tconfirmBeforeUndo: explorerConfig.confirmUndo === UndoConfirmLevel.Default || explorerConfig.confirmUndo === UndoConfirmLevel.Verbose,\n\t\t\tundoLabel: localize('copy', \"Copy {0}\", labelSuffix),\n\t\t\tprogressLabel: localize('copying', \"Copying {0}\", labelSuffix),\n\t\t});\n\n\t\tconst editors = resourceFileEdits.filter(edit => {\n\t\t\tconst item = edit.newResource ? this.explorerService.findClosest(edit.newResource) : undefined;\n\t\t\treturn item && !item.isDirectory;\n\t\t}).map(edit => ({ resource: edit.newResource, options: { pinned: true } }));\n\n\t\tawait this.editorService.openEditors(editors);\n\t}\n\n\tprivate async doHandleExplorerDropOnMove(sources: ExplorerItem[], target: ExplorerItem): Promise<void> {\n\n\t\t// Do not allow moving readonly items\n\t\tconst resourceFileEdits = sources.filter(source => !source.isReadonly).map(source => new ResourceFileEdit(source.resource, joinPath(target.resource, source.name)));\n\t\tconst labelSuffix = getFileOrFolderLabelSuffix(sources);\n\t\tconst options = {\n\t\t\tconfirmBeforeUndo: this.configurationService.getValue<IFilesConfiguration>().explorer.confirmUndo === UndoConfirmLevel.Verbose,\n\t\t\tundoLabel: localize('move', \"Move {0}\", labelSuffix),\n\t\t\tprogressLabel: localize('moving', \"Moving {0}\", labelSuffix)\n\t\t};\n\n\t\ttry {\n\t\t\tawait this.explorerService.applyBulkEdit(resourceFileEdits, options);\n\t\t} catch (error) {\n\n\t\t\t// Conflict\n\t\t\tif ((<FileOperationError>error).fileOperationResult === FileOperationResult.FILE_MOVE_CONFLICT) {\n\n\t\t\t\tconst overwrites: URI[] = [];\n\t\t\t\tfor (const edit of resourceFileEdits) {\n\t\t\t\t\tif (edit.newResource && await this.fileService.exists(edit.newResource)) {\n\t\t\t\t\t\toverwrites.push(edit.newResource);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Move with overwrite if the user confirms\n\t\t\t\tconst confirm = getMultipleFilesOverwriteConfirm(overwrites);\n\t\t\t\tconst { confirmed } = await this.dialogService.confirm(confirm);\n\t\t\t\tif (confirmed) {\n\t\t\t\t\tawait this.explorerService.applyBulkEdit(resourceFileEdits.map(re => new ResourceFileEdit(re.oldResource, re.newResource, { overwrite: true })), options);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Any other error: bubble up\n\t\t\telse {\n\t\t\t\tthrow error;\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate static getStatsFromDragAndDropData(data: ElementsDragAndDropData<ExplorerItem, ExplorerItem[]>, dragStartEvent?: DragEvent): ExplorerItem[] {\n\t\tif (data.context) {\n\t\t\treturn data.context;\n\t\t}\n\n\t\t// Detect compressed folder dragging\n\t\tif (dragStartEvent && data.elements.length === 1) {\n\t\t\tdata.context = [FileDragAndDrop.getCompressedStatFromDragEvent(data.elements[0], dragStartEvent)];\n\t\t\treturn data.context;\n\t\t}\n\n\t\treturn data.elements;\n\t}\n\n\tprivate static getCompressedStatFromDragEvent(stat: ExplorerItem, dragEvent: DragEvent): ExplorerItem {\n\t\tconst target = document.elementFromPoint(dragEvent.clientX, dragEvent.clientY);\n\t\tconst iconLabelName = getIconLabelNameFromHTMLElement(target);\n\n\t\tif (iconLabelName) {\n\t\t\tconst { count, index } = iconLabelName;\n\n\t\t\tlet i = count - 1;\n\t\t\twhile (i > index && stat.parent) {\n\t\t\t\tstat = stat.parent;\n\t\t\t\ti--;\n\t\t\t}\n\n\t\t\treturn stat;\n\t\t}\n\n\t\treturn stat;\n\t}\n\n\tonDragEnd(): void {\n\t\tthis.compressedDropTargetDisposable.dispose();\n\t}\n}\n\nfunction getIconLabelNameFromHTMLElement(target: HTMLElement | EventTarget | Element | null): { element: HTMLElement; count: number; index: number } | null {\n\tif (!(target instanceof HTMLElement)) {\n\t\treturn null;\n\t}\n\n\tlet element: HTMLElement | null = target;\n\n\twhile (element && !element.classList.contains('monaco-list-row')) {\n\t\tif (element.classList.contains('label-name') && element.hasAttribute('data-icon-label-count')) {\n\t\t\tconst count = Number(element.getAttribute('data-icon-label-count'));\n\t\t\tconst index = Number(element.getAttribute('data-icon-label-index'));\n\n\t\t\tif (isNumber(count) && isNumber(index)) {\n\t\t\t\treturn { element: element, count, index };\n\t\t\t}\n\t\t}\n\n\t\telement = element.parentElement;\n\t}\n\n\treturn null;\n}\n\nexport function isCompressedFolderName(target: HTMLElement | EventTarget | Element | null): boolean {\n\treturn !!getIconLabelNameFromHTMLElement(target);\n}\n\nexport class ExplorerCompressionDelegate implements ITreeCompressionDelegate<ExplorerItem> {\n\n\tisIncompressible(stat: ExplorerItem): boolean {\n\t\treturn stat.isRoot || !stat.isDirectory || stat instanceof NewExplorerItem || (!stat.parent || stat.parent.isRoot);\n\t}\n}\n\nfunction getFileOrFolderLabelSuffix(items: ExplorerItem[]): string {\n\tif (items.length === 1) {\n\t\treturn items[0].name;\n\t}\n\n\tif (items.every(i => i.isDirectory)) {\n\t\treturn localize('numberOfFolders', \"{0} folders\", items.length);\n\t}\n\tif (items.every(i => !i.isDirectory)) {\n\t\treturn localize('numberOfFiles', \"{0} files\", items.length);\n\t}\n\n\treturn `${items.length} files and folders`;\n}\n"]}